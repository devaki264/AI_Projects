<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Devakinandan Palla">

<title>AI Coursework Projects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="AI_Projects__files/libs/clipboard/clipboard.min.js"></script>
<script src="AI_Projects__files/libs/quarto-html/quarto.js"></script>
<script src="AI_Projects__files/libs/quarto-html/popper.min.js"></script>
<script src="AI_Projects__files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="AI_Projects__files/libs/quarto-html/anchor.min.js"></script>
<link href="AI_Projects__files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="AI_Projects__files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="AI_Projects__files/libs/bootstrap/bootstrap.min.js"></script>
<link href="AI_Projects__files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="AI_Projects__files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#list-of-projects-on-artificial-intelligence" id="toc-list-of-projects-on-artificial-intelligence" class="nav-link active" data-scroll-target="#list-of-projects-on-artificial-intelligence"><strong>List of Projects on Artificial Intelligence:</strong></a></li>
  <li><a href="#module-1---artificial-neural-networks-ann" id="toc-module-1---artificial-neural-networks-ann" class="nav-link" data-scroll-target="#module-1---artificial-neural-networks-ann">Module 1 - Artificial Neural Networks (ANN)</a>
  <ul class="collapse">
  <li><a href="#implementation-of-an-artificial-neural-network-ann-model-to-predict-whether-a-patient-will-experience-a-death-event-based-on-various-clinical-features-in-the-dataset" id="toc-implementation-of-an-artificial-neural-network-ann-model-to-predict-whether-a-patient-will-experience-a-death-event-based-on-various-clinical-features-in-the-dataset" class="nav-link" data-scroll-target="#implementation-of-an-artificial-neural-network-ann-model-to-predict-whether-a-patient-will-experience-a-death-event-based-on-various-clinical-features-in-the-dataset">Implementation of an Artificial Neural Network (ANN) model to predict whether a patient will experience a death event based on various clinical features in the dataset</a></li>
  </ul></li>
  <li><a href="#ann-images" id="toc-ann-images" class="nav-link" data-scroll-target="#ann-images">ANN Images</a>
  <ul class="collapse">
  <li><a href="#building-a-deep-learning-model-that-can-accurately-recognize-handwritten-digits-based-on-the-mnist-dataset" id="toc-building-a-deep-learning-model-that-can-accurately-recognize-handwritten-digits-based-on-the-mnist-dataset" class="nav-link" data-scroll-target="#building-a-deep-learning-model-that-can-accurately-recognize-handwritten-digits-based-on-the-mnist-dataset">Building a deep learning model that can accurately recognize handwritten digits based on the MNIST dataset</a></li>
  </ul></li>
  <li><a href="#module-2---cnn" id="toc-module-2---cnn" class="nav-link" data-scroll-target="#module-2---cnn">Module 2 - CNN</a>
  <ul class="collapse">
  <li><a href="#implementing-a-convolutional-neural-network-cnn-to-classify-images-of-brain-tumors-into-four-distinct-categories" id="toc-implementing-a-convolutional-neural-network-cnn-to-classify-images-of-brain-tumors-into-four-distinct-categories" class="nav-link" data-scroll-target="#implementing-a-convolutional-neural-network-cnn-to-classify-images-of-brain-tumors-into-four-distinct-categories">Implementing a Convolutional Neural Network (CNN) to classify images of brain tumors into four distinct categories</a></li>
  <li><a href="#braintumour" id="toc-braintumour" class="nav-link" data-scroll-target="#braintumour">BrainTumour</a></li>
  </ul></li>
  <li><a href="#module-3---rnn" id="toc-module-3---rnn" class="nav-link" data-scroll-target="#module-3---rnn">Module 3 - RNN</a>
  <ul class="collapse">
  <li><a href="#classification-of-names-as-either-male-or-female-using-a-character-level-recurrent-neural-network-rnn" id="toc-classification-of-names-as-either-male-or-female-using-a-character-level-recurrent-neural-network-rnn" class="nav-link" data-scroll-target="#classification-of-names-as-either-male-or-female-using-a-character-level-recurrent-neural-network-rnn">Classification of names as either male or female using a character-level recurrent neural network (RNN)</a></li>
  <li><a href="#gender-classification" id="toc-gender-classification" class="nav-link" data-scroll-target="#gender-classification">Gender Classification</a></li>
  <li><a href="#email-classifcation" id="toc-email-classifcation" class="nav-link" data-scroll-target="#email-classifcation">Email Classifcation</a></li>
  <li><a href="#implementing-a-basic-recurrent-neural-network-rnn-for-email-classification-to-determine-whether-an-email-is-spam-or-non-spam" id="toc-implementing-a-basic-recurrent-neural-network-rnn-for-email-classification-to-determine-whether-an-email-is-spam-or-non-spam" class="nav-link" data-scroll-target="#implementing-a-basic-recurrent-neural-network-rnn-for-email-classification-to-determine-whether-an-email-is-spam-or-non-spam">Implementing a basic Recurrent Neural Network (RNN) for email classification to determine whether an email is spam or non-spam</a></li>
  <li><a href="#sentiment-analysis" id="toc-sentiment-analysis" class="nav-link" data-scroll-target="#sentiment-analysis">Sentiment Analysis</a></li>
  <li><a href="#analyzing-the-sentiment-based-on-textual-statements-using-natural-language-processing" id="toc-analyzing-the-sentiment-based-on-textual-statements-using-natural-language-processing" class="nav-link" data-scroll-target="#analyzing-the-sentiment-based-on-textual-statements-using-natural-language-processing">Analyzing the sentiment based on textual statements using Natural Language processing</a></li>
  </ul></li>
  <li><a href="#module-3---next-word-prediction" id="toc-module-3---next-word-prediction" class="nav-link" data-scroll-target="#module-3---next-word-prediction">Module 3 - Next Word Prediction</a>
  <ul class="collapse">
  <li><a href="#predicting-the-next-word-based-on-incomplete-sentences" id="toc-predicting-the-next-word-based-on-incomplete-sentences" class="nav-link" data-scroll-target="#predicting-the-next-word-based-on-incomplete-sentences">Predicting the next word based on incomplete sentences</a></li>
  </ul></li>
  <li><a href="#module-4---q-learning" id="toc-module-4---q-learning" class="nav-link" data-scroll-target="#module-4---q-learning">Module 4 - Q Learning</a>
  <ul class="collapse">
  <li><a href="#implementation-of-q-learning-a-reinforcement-learning-algorithm-to-train-an-agent-to-navigate-through-a-grid-based-environment-and-reach-a-goal-state-while-avoiding-obstacle" id="toc-implementation-of-q-learning-a-reinforcement-learning-algorithm-to-train-an-agent-to-navigate-through-a-grid-based-environment-and-reach-a-goal-state-while-avoiding-obstacle" class="nav-link" data-scroll-target="#implementation-of-q-learning-a-reinforcement-learning-algorithm-to-train-an-agent-to-navigate-through-a-grid-based-environment-and-reach-a-goal-state-while-avoiding-obstacle">Implementation of Q-learning, a reinforcement learning algorithm, to train an agent to navigate through a grid-based environment and reach a goal state while avoiding obstacle</a></li>
  </ul></li>
  <li><a href="#module-5---autoencoders" id="toc-module-5---autoencoders" class="nav-link" data-scroll-target="#module-5---autoencoders">Module 5 - Autoencoders</a>
  <ul class="collapse">
  <li><a href="#vanilla" id="toc-vanilla" class="nav-link" data-scroll-target="#vanilla">Vanilla</a></li>
  <li><a href="#implementation-of-a-vanilla-autoencoder-using-keras-to-compress-and-reconstruct-images-from-the-mnist-dataset-which-contains-grayscale-images-of-handwritten-digits." id="toc-implementation-of-a-vanilla-autoencoder-using-keras-to-compress-and-reconstruct-images-from-the-mnist-dataset-which-contains-grayscale-images-of-handwritten-digits." class="nav-link" data-scroll-target="#implementation-of-a-vanilla-autoencoder-using-keras-to-compress-and-reconstruct-images-from-the-mnist-dataset-which-contains-grayscale-images-of-handwritten-digits.">Implementation of a vanilla autoencoder using Keras to compress and reconstruct images from the MNIST dataset, which contains grayscale images of handwritten digits.</a></li>
  <li><a href="#sparse" id="toc-sparse" class="nav-link" data-scroll-target="#sparse">Sparse</a></li>
  <li><a href="#this-sparse-autoencoder-demonstrates-how-to-enforce-sparsity-in-the-hidden-layer-while-learning-compact-representations-of-data.-it-successfully-reconstructs-images-from-their-compressed-representations-making-it-a-powerful-tool-for-dimensionality-reduction-and-feature-learning" id="toc-this-sparse-autoencoder-demonstrates-how-to-enforce-sparsity-in-the-hidden-layer-while-learning-compact-representations-of-data.-it-successfully-reconstructs-images-from-their-compressed-representations-making-it-a-powerful-tool-for-dimensionality-reduction-and-feature-learning" class="nav-link" data-scroll-target="#this-sparse-autoencoder-demonstrates-how-to-enforce-sparsity-in-the-hidden-layer-while-learning-compact-representations-of-data.-it-successfully-reconstructs-images-from-their-compressed-representations-making-it-a-powerful-tool-for-dimensionality-reduction-and-feature-learning">This sparse autoencoder demonstrates how to enforce sparsity in the hidden layer while learning compact representations of data. It successfully reconstructs images from their compressed representations, making it a powerful tool for dimensionality reduction and feature learning</a></li>
  <li><a href="#deep" id="toc-deep" class="nav-link" data-scroll-target="#deep">Deep</a></li>
  <li><a href="#implementation-of-a-deep-autoencoder-using-keras-to-compress-and-reconstruct-images-from-the-mnist-dataset" id="toc-implementation-of-a-deep-autoencoder-using-keras-to-compress-and-reconstruct-images-from-the-mnist-dataset" class="nav-link" data-scroll-target="#implementation-of-a-deep-autoencoder-using-keras-to-compress-and-reconstruct-images-from-the-mnist-dataset">Implementation of a deep autoencoder using Keras to compress and reconstruct images from the MNIST dataset</a></li>
  <li><a href="#denoise" id="toc-denoise" class="nav-link" data-scroll-target="#denoise">Denoise</a></li>
  <li><a href="#implementation-of-a-denoising-autoencoder-using-keras-to-remove-noise-from-images-in-the-mnist-dataset" id="toc-implementation-of-a-denoising-autoencoder-using-keras-to-remove-noise-from-images-in-the-mnist-dataset" class="nav-link" data-scroll-target="#implementation-of-a-denoising-autoencoder-using-keras-to-remove-noise-from-images-in-the-mnist-dataset">Implementation of a denoising autoencoder using Keras to remove noise from images in the MNIST dataset</a></li>
  </ul></li>
  <li><a href="#module-5---genetic-algo" id="toc-module-5---genetic-algo" class="nav-link" data-scroll-target="#module-5---genetic-algo">Module 5 - Genetic Algo</a>
  <ul class="collapse">
  <li><a href="#implementation-of-a-genetic-algorithm-used-to-optimize-the-hyperparameters-of-a-neural-network-trained-on-the-iris-dataset." id="toc-implementation-of-a-genetic-algorithm-used-to-optimize-the-hyperparameters-of-a-neural-network-trained-on-the-iris-dataset." class="nav-link" data-scroll-target="#implementation-of-a-genetic-algorithm-used-to-optimize-the-hyperparameters-of-a-neural-network-trained-on-the-iris-dataset.">implementation of a genetic algorithm used to optimize the hyperparameters of a neural network trained on the Iris dataset.</a></li>
  </ul></li>
  <li><a href="#module-5---gan" id="toc-module-5---gan" class="nav-link" data-scroll-target="#module-5---gan">Module 5 - GAN</a>
  <ul class="collapse">
  <li><a href="#implementation-of-a-generative-adversarial-network-gan-to-generate-synthetic-mnist-like-grayscale-images-of-handwritten-digits" id="toc-implementation-of-a-generative-adversarial-network-gan-to-generate-synthetic-mnist-like-grayscale-images-of-handwritten-digits" class="nav-link" data-scroll-target="#implementation-of-a-generative-adversarial-network-gan-to-generate-synthetic-mnist-like-grayscale-images-of-handwritten-digits">Implementation of a Generative Adversarial Network (GAN) to generate synthetic MNIST-like grayscale images of handwritten digits</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">AI Coursework Projects</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Devakinandan Palla </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="list-of-projects-on-artificial-intelligence" class="level1">
<h1><strong>List of Projects on Artificial Intelligence:</strong></h1>
</section>
<section id="module-1---artificial-neural-networks-ann" class="level1">
<h1>Module 1 - Artificial Neural Networks (ANN)</h1>
<section id="implementation-of-an-artificial-neural-network-ann-model-to-predict-whether-a-patient-will-experience-a-death-event-based-on-various-clinical-features-in-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="implementation-of-an-artificial-neural-network-ann-model-to-predict-whether-a-patient-will-experience-a-death-event-based-on-various-clinical-features-in-the-dataset">Implementation of an Artificial Neural Network (ANN) model to predict whether a patient will experience a death event based on various clinical features in the dataset</h2>
<div id="cell-4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense, Dropout</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> Adam</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-5" class="cell" data-outputid="1f219cf5-93e2-4c4a-dcfc-84c8419674d6" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Import and EDA</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"/content/Heart_failure_clinical_records_dataset.csv"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">

  <div id="df-d58bd127-f633-4c98-ab91-a97a2fe562fe" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">anaemia</th>
<th data-quarto-table-cell-role="th">creatinine_phosphokinase</th>
<th data-quarto-table-cell-role="th">diabetes</th>
<th data-quarto-table-cell-role="th">ejection_fraction</th>
<th data-quarto-table-cell-role="th">high_blood_pressure</th>
<th data-quarto-table-cell-role="th">platelets</th>
<th data-quarto-table-cell-role="th">serum_creatinine</th>
<th data-quarto-table-cell-role="th">serum_sodium</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">smoking</th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">DEATH_EVENT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>75.0</td>
<td>0</td>
<td>582</td>
<td>0</td>
<td>20</td>
<td>1</td>
<td>265000.00</td>
<td>1.9</td>
<td>130</td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>55.0</td>
<td>0</td>
<td>7861</td>
<td>0</td>
<td>38</td>
<td>0</td>
<td>263358.03</td>
<td>1.1</td>
<td>136</td>
<td>1</td>
<td>0</td>
<td>6</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>65.0</td>
<td>0</td>
<td>146</td>
<td>0</td>
<td>20</td>
<td>0</td>
<td>162000.00</td>
<td>1.3</td>
<td>129</td>
<td>1</td>
<td>1</td>
<td>7</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>50.0</td>
<td>1</td>
<td>111</td>
<td>0</td>
<td>20</td>
<td>0</td>
<td>210000.00</td>
<td>1.9</td>
<td>137</td>
<td>1</td>
<td>0</td>
<td>7</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>65.0</td>
<td>1</td>
<td>160</td>
<td>1</td>
<td>20</td>
<td>0</td>
<td>327000.00</td>
<td>2.7</td>
<td>116</td>
<td>0</td>
<td>0</td>
<td>8</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d58bd127-f633-4c98-ab91-a97a2fe562fe')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d58bd127-f633-4c98-ab91-a97a2fe562fe button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d58bd127-f633-4c98-ab91-a97a2fe562fe');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1605ed58-4b7e-481c-9b03-0f00609cdabc">
  <button class="colab-df-quickchart" onclick="quickchart('df-1605ed58-4b7e-481c-9b03-0f00609cdabc')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1605ed58-4b7e-481c-9b03-0f00609cdabc button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div>
</div>
<div id="cell-6" class="cell" data-outputid="6a91eb6e-4477-44a9-dedf-631916f46f6d" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>0</code></pre>
</div>
</div>
<div id="cell-7" class="cell" data-outputid="087fdff6-01b4-4f52-d693-e1d1cbd4a387" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Train test split and shape</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> data.drop([<span class="st">"DEATH_EVENT"</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">"DEATH_EVENT"</span>]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x, y, test_size <span class="op">=</span> <span class="fl">0.25</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_train.shape)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_test.shape)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard Scaling</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>sc <span class="op">=</span> StandardScaler()</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> sc.fit_transform(x_train)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> sc.fit_transform(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(224, 12)
(75, 12)</code></pre>
</div>
</div>
<div id="cell-8" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Model</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>classifier <span class="op">=</span> Sequential()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>classifier.add(Dense(<span class="dv">12</span>, activation <span class="op">=</span> <span class="st">"relu"</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>classifier.add(Dropout(<span class="fl">0.3</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>classifier.add(Dense(<span class="dv">7</span>, activation <span class="op">=</span> <span class="st">"relu"</span>))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>classifier.add(Dropout(<span class="fl">0.3</span>))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>classifier.add(Dense(<span class="dv">3</span>, activation <span class="op">=</span> <span class="st">"relu"</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>classifier.add(Dropout(<span class="fl">0.3</span>))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>classifier.add(Dense(<span class="dv">1</span>, activation <span class="op">=</span> <span class="st">"sigmoid"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Compile</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>classifier.<span class="bu">compile</span>(optimizer <span class="op">=</span> <span class="st">'Adam'</span>, loss <span class="op">=</span> <span class="st">'binary_crossentropy'</span>, metrics <span class="op">=</span> [<span class="st">'accuracy'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-10" class="cell" data-outputid="6bb83f31-f4b4-46a4-c2f3-7eaf926d830a" data-execution_count="15">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Fit</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># earlystopping = EarlyStopping(monitor = 'val_loss', min_delta = 0.1, patience = 5, verbose = 0)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>model_history <span class="op">=</span> classifier.fit(x_train, y_train, epochs<span class="op">=</span><span class="dv">5</span>, validation_split<span class="op">=</span><span class="fl">0.2</span>, verbose<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/5
6/6 ━━━━━━━━━━━━━━━━━━━━ 7s 593ms/step - accuracy: 0.4989 - loss: 0.9297 - val_accuracy: 0.3778 - val_loss: 0.7791
Epoch 2/5
6/6 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.4571 - loss: 0.9354 - val_accuracy: 0.3778 - val_loss: 0.7664
Epoch 3/5
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.5157 - loss: 0.8244 - val_accuracy: 0.4222 - val_loss: 0.7545
Epoch 4/5
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.4659 - loss: 0.8866 - val_accuracy: 0.4222 - val_loss: 0.7435
Epoch 5/5
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.5052 - loss: 0.7700 - val_accuracy: 0.4444 - val_loss: 0.7334</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-outputid="df3eba2f-8fe9-46b2-8147-b844cf2a5930" data-execution_count="16">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>model_history.history.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>dict_keys(['accuracy', 'loss', 'val_accuracy', 'val_loss'])</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-outputid="ddee90a8-6832-4d88-83e7-43e047c28a83" data-execution_count="17">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Extract accuracy values from model history</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> model_history.history[<span class="st">'accuracy'</span>][<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>val_accuracy <span class="op">=</span> model_history.history[<span class="st">'val_accuracy'</span>][<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training Accuracy: </span><span class="sc">{:.2f}</span><span class="st">%"</span>.<span class="bu">format</span>(accuracy))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Validation Accuracy: </span><span class="sc">{:.2f}</span><span class="st">%"</span>.<span class="bu">format</span>(val_accuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training Accuracy: 51.40%
Validation Accuracy: 44.44%</code></pre>
</div>
</div>
<div id="cell-13" class="cell" data-outputid="b0e09c57-4ef7-449e-ab0e-41baabde77da" data-execution_count="18">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Prediction and Confusion matrix</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>y_predicted <span class="op">=</span> classifier.predict(x_test)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>y_predicted_labels <span class="op">=</span> [np.argmax(i) <span class="cf">for</span> i <span class="kw">in</span> y_predicted]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> tf.math.confusion_matrix(labels <span class="op">=</span> y_test,predictions <span class="op">=</span> y_predicted_labels)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">5</span>,<span class="dv">4</span>))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm,annot <span class="op">=</span> <span class="va">True</span>,fmt <span class="op">=</span> <span class="st">'d'</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Predicted"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Truth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 74ms/step</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Text(33.22222222222222, 0.5, 'Truth')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AI_Projects__files/figure-html/cell-11-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-14" class="cell" data-outputid="5fe17769-a169-475b-eaa5-1d3783fd54fa" data-execution_count="19">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Plottings</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">5</span>,<span class="dv">4</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>plt.plot(model_history.history[<span class="st">'accuracy'</span>])</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>plt.plot(model_history.history[<span class="st">'val_accuracy'</span>])</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Model accuracy'</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'accuracy'</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'train'</span>,<span class="st">'test'</span>],loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AI_Projects__files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-15" class="cell" data-outputid="0dfa588b-8c9a-4ec3-f10c-ee73afa14d6b" data-execution_count="20">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">5</span>,<span class="dv">4</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>plt.plot(model_history.history[<span class="st">'loss'</span>])</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>plt.plot(model_history.history[<span class="st">'val_loss'</span>])</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Model Loss'</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'accuracy'</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'train'</span>,<span class="st">'test'</span>],loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AI_Projects__files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ann-images" class="level1">
<h1>ANN Images</h1>
<section id="building-a-deep-learning-model-that-can-accurately-recognize-handwritten-digits-based-on-the-mnist-dataset" class="level2">
<h2 class="anchored" data-anchor-id="building-a-deep-learning-model-that-can-accurately-recognize-handwritten-digits-based-on-the-mnist-dataset">Building a deep learning model that can accurately recognize handwritten digits based on the MNIST dataset</h2>
<div id="cell-18" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.datasets <span class="im">import</span> mnist</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-19" class="cell" data-outputid="f807a370-e0e0-4963-fe04-a59498fef7b6" data-execution_count="22">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the MNIST dataset, which contains handwritten digits, and splits it into training and testing sets.</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>(X_train, y_train) , (X_test, y_test) <span class="op">=</span> mnist.load_data()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
11490434/11490434 ━━━━━━━━━━━━━━━━━━━━ 0s 0us/step</code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-outputid="33625339-9d1c-437f-92ae-4013989c5f55" data-execution_count="23">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring Dataset</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#1. Checking the size of dataset</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(X_train))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(X_test))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#2. Shape of first image</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train[<span class="dv">0</span>].shape)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Label and Image of 5th image</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>plt.matshow(X_train[<span class="dv">4</span>])</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Label:"</span>, y_train[<span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>60000
10000
(28, 28)
Label: 9</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AI_Projects__files/figure-html/cell-16-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data preprocessing</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalizing the pixel values of the images to be between 0 and 1.</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>X_train<span class="op">=</span>X_train<span class="op">/</span><span class="dv">255</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>X_test<span class="op">=</span>X_test<span class="op">/</span><span class="dv">255</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-22" class="cell" data-outputid="f71e1743-0edc-4917-f3ee-8c56551e4e45" data-execution_count="25">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Flatten layer so that we don't have to call .reshape on input dataset</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Flatten,Dense</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>model.add(Flatten(input_shape<span class="op">=</span>(<span class="dv">28</span>, <span class="dv">28</span>)))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">100</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">10</span>, activation<span class="op">=</span><span class="st">'softmax'</span>))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'sparse_categorical_crossentropy'</span>, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train, epochs<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10
1875/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 2ms/step - accuracy: 0.8756 - loss: 0.4509
Epoch 2/10
1875/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 2ms/step - accuracy: 0.9620 - loss: 0.1291
Epoch 3/10
1875/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 2ms/step - accuracy: 0.9746 - loss: 0.0849
Epoch 4/10
1875/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 1ms/step - accuracy: 0.9811 - loss: 0.0644
Epoch 5/10
1875/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 2ms/step - accuracy: 0.9853 - loss: 0.0481
Epoch 6/10
1875/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 2ms/step - accuracy: 0.9886 - loss: 0.0378
Epoch 7/10
1875/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 3ms/step - accuracy: 0.9896 - loss: 0.0328
Epoch 8/10
1875/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 2ms/step - accuracy: 0.9917 - loss: 0.0261
Epoch 9/10
1875/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 2ms/step - accuracy: 0.9938 - loss: 0.0206
Epoch 10/10
1875/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 2ms/step - accuracy: 0.9946 - loss: 0.0173</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>&lt;keras.src.callbacks.history.History at 0x7ec76c3e61d0&gt;</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-outputid="7b955a1b-9d69-4c50-c69b-9e815c4dc4b9" data-execution_count="26">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model.evaluate(X_test, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>313/313 ━━━━━━━━━━━━━━━━━━━━ 1s 3ms/step - accuracy: 0.9726 - loss: 0.0975</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>[0.08356696367263794, 0.9768000245094299]</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-outputid="d9b43248-ccd6-4a53-a9c3-43ea120493b9" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluating and Visualizing Model Performance</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>y_predicted <span class="op">=</span> model.predict(X_test)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>np.argmax(y_predicted[<span class="dv">0</span>])</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>y_predicted_labels <span class="op">=</span> [np.argmax(i) <span class="cf">for</span> i <span class="kw">in</span> y_predicted]</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> tf.math.confusion_matrix(labels<span class="op">=</span>y_test, predictions<span class="op">=</span>y_predicted_labels)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">7</span>))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Predicted'</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Truth'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>WARNING:tensorflow:5 out of the last 7 calls to &lt;function TensorFlowTrainer.make_predict_function.&lt;locals&gt;.one_step_on_data_distributed at 0x7ec76c20e200&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>313/313 ━━━━━━━━━━━━━━━━━━━━ 1s 2ms/step</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>Text(95.72222222222221, 0.5, 'Truth')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AI_Projects__files/figure-html/cell-20-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="module-2---cnn" class="level1">
<h1>Module 2 - CNN</h1>
<section id="implementing-a-convolutional-neural-network-cnn-to-classify-images-of-brain-tumors-into-four-distinct-categories" class="level2">
<h2 class="anchored" data-anchor-id="implementing-a-convolutional-neural-network-cnn-to-classify-images-of-brain-tumors-into-four-distinct-categories">Implementing a Convolutional Neural Network (CNN) to classify images of brain tumors into four distinct categories</h2>
</section>
<section id="braintumour" class="level2">
<h2 class="anchored" data-anchor-id="braintumour">BrainTumour</h2>
<div id="cell-28" class="cell" data-outputid="928d64d5-d232-4302-e263-b08688fec58f" data-execution_count="28">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>unzip <span class="op">-</span>u <span class="st">"/content/BrainTumour.zip"</span> <span class="op">-</span>d <span class="st">"/content/BrainTumour"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>unzip:  cannot find or open /content/BrainTumour.zip, /content/BrainTumour.zip.zip or /content/BrainTumour.zip.ZIP.</code></pre>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Conv2D,MaxPool2D,Dense,Dropout,Flatten</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.regularizers <span class="im">import</span> l2</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> Adam, Adagrad</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.metrics <span class="im">import</span> categorical_crossentropy</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-30" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Importing</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>train_path <span class="op">=</span> <span class="st">'/content/drive/MyDrive/BrainTumour/Training'</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>test_path <span class="op">=</span> <span class="st">'/content/drive/MyDrive/BrainTumour/Testing'</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>train_datagen <span class="op">=</span> ImageDataGenerator(validation_split <span class="op">=</span> <span class="fl">0.2</span>,rescale <span class="op">=</span> <span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>test_datagen <span class="op">=</span> ImageDataGenerator(rescale <span class="op">=</span> <span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-31" class="cell" data-outputid="061e5c56-8033-4dc3-c2c3-be441eedc21e" data-execution_count="34">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. train validation test batches</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>train_batches <span class="op">=</span> train_datagen.flow_from_directory(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    train_path,target_size <span class="op">=</span> (<span class="dv">64</span>,<span class="dv">64</span>),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    subset <span class="op">=</span> <span class="st">'training'</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    class_mode <span class="op">=</span> <span class="st">'categorical'</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>validation_batches <span class="op">=</span> train_datagen.flow_from_directory(</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    train_path,target_size <span class="op">=</span> (<span class="dv">64</span>,<span class="dv">64</span>),</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    subset <span class="op">=</span> <span class="st">'validation'</span>,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    class_mode <span class="op">=</span> <span class="st">'categorical'</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>test_batches <span class="op">=</span> test_datagen.flow_from_directory(</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    test_path,target_size <span class="op">=</span> (<span class="dv">64</span>,<span class="dv">64</span>),</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span>,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    subset <span class="op">=</span> <span class="st">'training'</span>,</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    class_mode <span class="op">=</span> <span class="st">'categorical'</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 2297 images belonging to 4 classes.
Found 573 images belonging to 4 classes.
Found 394 images belonging to 4 classes.</code></pre>
</div>
</div>
<div id="cell-32" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Model</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">32</span>,<span class="dv">3</span>,activation <span class="op">=</span> <span class="st">'relu'</span>,input_shape <span class="op">=</span> (<span class="dv">64</span>,<span class="dv">64</span>,<span class="dv">3</span>)))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.25</span>))</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">64</span>,<span class="dv">3</span>,activation<span class="op">=</span><span class="st">'relu'</span>,kernel_regularizer<span class="op">=</span>l2(<span class="fl">0.01</span>)))</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>model.add(MaxPool2D())</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>model.add(Flatten())</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Hidden Layer</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># model -1</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">128</span>,activation <span class="op">=</span> <span class="st">'relu'</span>))</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.25</span>))</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># model-2</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">64</span>,activation <span class="op">=</span> <span class="st">'relu'</span>))</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.25</span>))</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="co"># model - 3</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">32</span>,activation <span class="op">=</span> <span class="st">'relu'</span>))</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.25</span>))</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="co"># output layer</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">4</span>,activation <span class="op">=</span> <span class="st">'softmax'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-33" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Two optimizers (Run whole code with another optimizer)</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'categorical_crossentropy'</span>, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-34" class="cell" data-outputid="7297e833-b539-44ad-9919-fc8e0bfd689e" data-execution_count="41">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. fit</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'val_loss'</span>, min_delta<span class="op">=</span><span class="fl">0.001</span>, patience<span class="op">=</span><span class="dv">5</span>, verbose<span class="op">=</span><span class="dv">0</span>, mode<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(x<span class="op">=</span>train_batches, validation_data<span class="op">=</span>validation_batches, epochs<span class="op">=</span><span class="dv">10</span>, verbose<span class="op">=</span><span class="dv">1</span>, callbacks<span class="op">=</span>[early_stopping])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/keras/src/trainers/data_adapters/py_dataset_adapter.py:122: UserWarning: Your `PyDataset` class should call `super().__init__(**kwargs)` in its constructor. `**kwargs` can include `workers`, `use_multiprocessing`, `max_queue_size`. Do not pass these arguments to `fit()`, as they will be ignored.
  self._warn_if_super_not_called()</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>72/72 ━━━━━━━━━━━━━━━━━━━━ 808s 10s/step - accuracy: 0.3467 - loss: 1.8245 - val_accuracy: 0.4206 - val_loss: 1.4145
Epoch 2/10
72/72 ━━━━━━━━━━━━━━━━━━━━ 12s 157ms/step - accuracy: 0.5367 - loss: 1.2050 - val_accuracy: 0.4311 - val_loss: 1.2383
Epoch 3/10
72/72 ━━━━━━━━━━━━━━━━━━━━ 12s 157ms/step - accuracy: 0.6636 - loss: 0.8612 - val_accuracy: 0.4869 - val_loss: 1.2506
Epoch 4/10
72/72 ━━━━━━━━━━━━━━━━━━━━ 20s 151ms/step - accuracy: 0.7309 - loss: 0.7505 - val_accuracy: 0.5969 - val_loss: 1.1680
Epoch 5/10
72/72 ━━━━━━━━━━━━━━━━━━━━ 12s 153ms/step - accuracy: 0.7583 - loss: 0.6144 - val_accuracy: 0.5654 - val_loss: 1.1919
Epoch 6/10
72/72 ━━━━━━━━━━━━━━━━━━━━ 21s 156ms/step - accuracy: 0.8128 - loss: 0.5177 - val_accuracy: 0.5637 - val_loss: 1.1800
Epoch 7/10
72/72 ━━━━━━━━━━━━━━━━━━━━ 12s 160ms/step - accuracy: 0.8489 - loss: 0.4061 - val_accuracy: 0.5707 - val_loss: 1.2865
Epoch 8/10
72/72 ━━━━━━━━━━━━━━━━━━━━ 20s 151ms/step - accuracy: 0.9017 - loss: 0.3188 - val_accuracy: 0.5620 - val_loss: 1.3848
Epoch 9/10
72/72 ━━━━━━━━━━━━━━━━━━━━ 12s 155ms/step - accuracy: 0.8880 - loss: 0.3302 - val_accuracy: 0.6021 - val_loss: 1.5668</code></pre>
</div>
</div>
<div id="cell-35" class="cell" data-outputid="8f38a4e1-9c28-4508-d147-e054e6a21f9d" data-execution_count="42">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Evalaution</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co">#history.history.keys()</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> history.history[<span class="st">'accuracy'</span>][<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>val_accuracy <span class="op">=</span> history.history[<span class="st">'val_accuracy'</span>][<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Training accuracy: </span><span class="sc">{</span><span class="bu">round</span>(accuracy, <span class="dv">2</span>)<span class="sc">}</span><span class="ss">%'</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Validation accuracy: </span><span class="sc">{</span><span class="bu">round</span>(val_accuracy, <span class="dv">2</span>)<span class="sc">}</span><span class="ss">%'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training accuracy: 89.81%
Validation accuracy: 60.21%</code></pre>
</div>
</div>
<div id="cell-36" class="cell" data-outputid="51b13844-9851-48f5-f0ba-5c24c076b905" data-execution_count="43">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Prediction and confusion matrix</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> model.predict(test_batches)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> np.<span class="bu">round</span>(predictions)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_true<span class="op">=</span>test_batches.classes,y_pred<span class="op">=</span>np.argmax(predictions,axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, xticklabels<span class="op">=</span>[<span class="st">"pituitary_tumor"</span>,<span class="st">'no_tumor'</span>,<span class="st">"meningioma_tumor"</span>,<span class="st">"glioma_tumor"</span>],</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>                 yticklabels<span class="op">=</span>[<span class="st">"pituitary_tumor"</span>,<span class="st">'no_tumor'</span>,<span class="st">"meningioma_tumor"</span>,<span class="st">"glioma_tumor"</span>],cbar<span class="op">=</span><span class="va">False</span>,cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Prediction'</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Actual'</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>13/13 ━━━━━━━━━━━━━━━━━━━━ 98s 8s/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AI_Projects__files/figure-html/cell-29-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-37" class="cell" data-outputid="eee643ff-0bcf-486b-bd9c-916f7b26dc56" data-execution_count="44">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Summarize history for accuracy</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'accuracy'</span>])</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'val_accuracy'</span>])</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'model accuracy'</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'accuracy'</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'epoch'</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Train'</span>, <span class="st">'Validation'</span>], loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AI_Projects__files/figure-html/cell-30-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-38" class="cell" data-outputid="ad797529-4906-44bc-ade8-935c7c143cb7" data-execution_count="45">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'loss'</span>])</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'val_loss'</span>])</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'model loss'</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'loss'</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'epoch'</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Train'</span>, <span class="st">'Validation'</span>], loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AI_Projects__files/figure-html/cell-31-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="module-3---rnn" class="level1">
<h1>Module 3 - RNN</h1>
<section id="classification-of-names-as-either-male-or-female-using-a-character-level-recurrent-neural-network-rnn" class="level2">
<h2 class="anchored" data-anchor-id="classification-of-names-as-either-male-or-female-using-a-character-level-recurrent-neural-network-rnn">Classification of names as either male or female using a character-level recurrent neural network (RNN)</h2>
</section>
<section id="gender-classification" class="level2">
<h2 class="anchored" data-anchor-id="gender-classification">Gender Classification</h2>
<div id="cell-42" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.text <span class="im">import</span> Tokenizer</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.sequence <span class="im">import</span> pad_sequences</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> SimpleRNN, Dense, Embedding</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-43" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>names <span class="op">=</span> [<span class="st">'John'</span>, <span class="st">'Jane'</span>, <span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Michael'</span>, <span class="st">'Mary'</span>, <span class="st">'David'</span>, <span class="st">'Sarah'</span>, <span class="st">'James'</span>, <span class="st">'Emily'</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">'William'</span>, <span class="st">'Emma'</span>, <span class="st">'Matthew'</span>, <span class="st">'Olivia'</span>, <span class="st">'Daniel'</span>, <span class="st">'Sophia'</span>, <span class="st">'Christopher'</span>, <span class="st">'Isabella'</span>, <span class="st">'Andrew'</span>, <span class="st">'Ava'</span>]</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>genders <span class="op">=</span> [<span class="st">'male'</span>, <span class="st">'female'</span>, <span class="st">'female'</span>, <span class="st">'male'</span>, <span class="st">'male'</span>, <span class="st">'female'</span>, <span class="st">'male'</span>, <span class="st">'female'</span>, <span class="st">'male'</span>, <span class="st">'female'</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">'male'</span>, <span class="st">'female'</span>, <span class="st">'male'</span>, <span class="st">'female'</span>, <span class="st">'male'</span>, <span class="st">'female'</span>, <span class="st">'male'</span>, <span class="st">'female'</span>, <span class="st">'male'</span>, <span class="st">'female'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-44" class="cell" data-outputid="320a2e16-9b10-44aa-b8f2-d9c55a00ba28" data-execution_count="55">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Preprocessing</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Convert names to numerical representation</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> Tokenizer(char_level<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>tokenizer.fit_on_texts(names)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Vocabulary:"</span>, tokenizer.word_index)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> tokenizer.texts_to_sequences(names)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Pad sequences to a fixed length</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>max_length <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(seq) <span class="cf">for</span> seq <span class="kw">in</span> X)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pad_sequences(X, maxlen<span class="op">=</span>max_length, padding<span class="op">=</span><span class="st">'post'</span>)</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(X)    <span class="co"># Convert to numpy array</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. One-hot encode genders</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">1</span> <span class="cf">if</span> gender <span class="op">==</span> <span class="st">'male'</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">for</span> gender <span class="kw">in</span> genders])</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Split dataset into training and testing sets</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(tokenizer.word_index))</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.shape[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Vocabulary: {'a': 1, 'i': 2, 'e': 3, 'l': 4, 'm': 5, 'h': 6, 'o': 7, 'r': 8, 's': 9, 'n': 10, 'd': 11, 'j': 12, 'c': 13, 'b': 14, 'v': 15, 'w': 16, 't': 17, 'y': 18, 'p': 19}
[[12, 7, 6, 10], [12, 1, 10, 3], [1, 4, 2, 13, 3], [14, 7, 14], [5, 2, 13, 6, 1, 3, 4], [5, 1, 8, 18], [11, 1, 15, 2, 11], [9, 1, 8, 1, 6], [12, 1, 5, 3, 9], [3, 5, 2, 4, 18], [16, 2, 4, 4, 2, 1, 5], [3, 5, 5, 1], [5, 1, 17, 17, 6, 3, 16], [7, 4, 2, 15, 2, 1], [11, 1, 10, 2, 3, 4], [9, 7, 19, 6, 2, 1], [13, 6, 8, 2, 9, 17, 7, 19, 6, 3, 8], [2, 9, 1, 14, 3, 4, 4, 1], [1, 10, 11, 8, 3, 16], [1, 15, 1]]
[[12  7  6 10  0  0  0  0  0  0  0]
 [12  1 10  3  0  0  0  0  0  0  0]
 [ 1  4  2 13  3  0  0  0  0  0  0]
 [14  7 14  0  0  0  0  0  0  0  0]
 [ 5  2 13  6  1  3  4  0  0  0  0]
 [ 5  1  8 18  0  0  0  0  0  0  0]
 [11  1 15  2 11  0  0  0  0  0  0]
 [ 9  1  8  1  6  0  0  0  0  0  0]
 [12  1  5  3  9  0  0  0  0  0  0]
 [ 3  5  2  4 18  0  0  0  0  0  0]
 [16  2  4  4  2  1  5  0  0  0  0]
 [ 3  5  5  1  0  0  0  0  0  0  0]
 [ 5  1 17 17  6  3 16  0  0  0  0]
 [ 7  4  2 15  2  1  0  0  0  0  0]
 [11  1 10  2  3  4  0  0  0  0  0]
 [ 9  7 19  6  2  1  0  0  0  0  0]
 [13  6  8  2  9 17  7 19  6  3  8]
 [ 2  9  1 14  3  4  4  1  0  0  0]
 [ 1 10 11  8  3 16  0  0  0  0  0]
 [ 1 15  1  0  0  0  0  0  0  0  0]]
19
11</code></pre>
</div>
</div>
<div id="cell-45" class="cell" data-outputid="90648ff6-1e71-4833-be7b-7a10665bb106" data-execution_count="56">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple RNN model</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>model.add(Embedding(input_dim<span class="op">=</span><span class="bu">len</span>(tokenizer.word_index) <span class="op">+</span> <span class="dv">1</span>, output_dim<span class="op">=</span><span class="dv">10</span>, input_length<span class="op">=</span>X.shape[<span class="dv">1</span>]))</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>model.add(SimpleRNN(<span class="dv">10</span>))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>))</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train, epochs<span class="op">=</span><span class="dv">10</span>, batch_size<span class="op">=</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>16/16 ━━━━━━━━━━━━━━━━━━━━ 3s 3ms/step - accuracy: 0.6526 - loss: 0.6732
Epoch 2/10
16/16 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 0.5441 - loss: 0.6660      
Epoch 3/10
16/16 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 0.9269 - loss: 0.5826 
Epoch 4/10
16/16 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 0.8733 - loss: 0.5417 
Epoch 5/10
16/16 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 0.9751 - loss: 0.4394 
Epoch 6/10
16/16 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 0.9053 - loss: 0.3288 
Epoch 7/10
16/16 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 1.0000 - loss: 0.2234
Epoch 8/10
16/16 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 1.0000 - loss: 0.1863 
Epoch 9/10
16/16 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 1.0000 - loss: 0.1059 
Epoch 10/10
16/16 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 1.0000 - loss: 0.0974</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>&lt;keras.src.callbacks.history.History at 0x7ec76c34d690&gt;</code></pre>
</div>
</div>
<div id="cell-46" class="cell" data-outputid="2a91236d-88a8-4f92-8842-66d28af0ac90" data-execution_count="57">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluation and validation</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>loss, accuracy <span class="op">=</span> model.evaluate(X_test, y_test, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Test Accuracy: </span><span class="sc">{</span>accuracy <span class="op">*</span> <span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test Accuracy: 25.00%</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-outputid="557e35fd-efcb-44a9-9a98-09824b0f7556" data-execution_count="58">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction and Testing</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to predict gender for a given name</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict_gender(name):</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    name_seq <span class="op">=</span> tokenizer.texts_to_sequences([name])   <span class="co"># Convert names to numerical representation</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    max_length <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(name_seq) <span class="cf">for</span> name_seq <span class="kw">in</span> X)     <span class="co"># Pad sequences to a fixed length</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    name_seq <span class="op">=</span> pad_sequences(name_seq, maxlen<span class="op">=</span>max_length, padding<span class="op">=</span><span class="st">'post'</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    name_seq <span class="op">=</span> np.array(name_seq)     <span class="co"># Convert to numpy array</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    prediction <span class="op">=</span> model.predict(name_seq)[<span class="dv">0</span>][<span class="dv">0</span>]       <span class="co"># Make the prediction</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    gender <span class="op">=</span> <span class="st">'male'</span> <span class="cf">if</span> prediction <span class="op">&gt;=</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'female'</span>       <span class="co"># Convert prediction to gender label</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> gender</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing with a random name</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>random_name <span class="op">=</span> <span class="st">'Emma'</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>predicted_gender <span class="op">=</span> predict_gender(random_name)</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The predicted gender for the name '</span><span class="sc">{</span>random_name<span class="sc">}</span><span class="ss">' is: </span><span class="sc">{</span>predicted_gender<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 265ms/step
The predicted gender for the name 'Emma' is: female</code></pre>
</div>
</div>
</section>
<section id="email-classifcation" class="level2">
<h2 class="anchored" data-anchor-id="email-classifcation">Email Classifcation</h2>
</section>
<section id="implementing-a-basic-recurrent-neural-network-rnn-for-email-classification-to-determine-whether-an-email-is-spam-or-non-spam" class="level2">
<h2 class="anchored" data-anchor-id="implementing-a-basic-recurrent-neural-network-rnn-for-email-classification-to-determine-whether-an-email-is-spam-or-non-spam">Implementing a basic Recurrent Neural Network (RNN) for email classification to determine whether an email is spam or non-spam</h2>
<div id="cell-50" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample Dataset :</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>messages <span class="op">=</span> [<span class="st">'Reminder:Your appointment is tomorrow at 10 AM'</span>,<span class="st">'Dont forget to submit your report by end of day'</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Thank you for your payment.Your order has been confirmed'</span>, <span class="st">'Your flight reservation has been successfully booked'</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Congratulations on your recent promotion! Well Deserved'</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Congratulations! You have qualified for a cashback reward'</span>,<span class="st">'Unlock VIP access and enjoy VIP-only perks and discounts'</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Get Free shipping on all orders for a limited time only'</span>,<span class="st">'Dont miss this chance to double your winnings.Click Now!'</span>,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Exclusive deal alert! Save up to 70</span><span class="sc">% o</span><span class="st">n select items'</span>]</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>            <span class="co"># names</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co"># gender</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 - Non Spam</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 - Spam</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-51" class="cell" data-outputid="320c55b5-b6ed-405c-ea20-330cb7905dfc" data-execution_count="91">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Preprocessing</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Convert names to numerical representation</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> Tokenizer(char_level<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>tokenizer.fit_on_texts(messages)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Vocabulary:"</span>, tokenizer.word_index)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> tokenizer.texts_to_sequences(messages)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Pad sequences to a fixed length</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>max_length <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(seq) <span class="cf">for</span> seq <span class="kw">in</span> X)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pad_sequences(X, maxlen<span class="op">=</span>max_length, padding<span class="op">=</span><span class="st">'post'</span>)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(X)    <span class="co"># Convert to numpy array</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. One-hot encode</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array(labels)</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Split dataset into training and testing sets</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(tokenizer.word_index))</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.shape[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Vocabulary: {'your': 1, 'to': 2, 'for': 3, 'on': 4, 'dont': 5, 'you': 6, 'has': 7, 'been': 8, 'congratulations': 9, 'a': 10, 'vip': 11, 'and': 12, 'only': 13, 'reminder': 14, 'appointment': 15, 'is': 16, 'tomorrow': 17, 'at': 18, '10': 19, 'am': 20, 'forget': 21, 'submit': 22, 'report': 23, 'by': 24, 'end': 25, 'of': 26, 'day': 27, 'thank': 28, 'payment': 29, 'order': 30, 'confirmed': 31, 'flight': 32, 'reservation': 33, 'successfully': 34, 'booked': 35, 'recent': 36, 'promotion': 37, 'well': 38, 'deserved': 39, 'have': 40, 'qualified': 41, 'cashback': 42, 'reward': 43, 'unlock': 44, 'access': 45, 'enjoy': 46, 'perks': 47, 'discounts': 48, 'get': 49, 'free': 50, 'shipping': 51, 'all': 52, 'orders': 53, 'limited': 54, 'time': 55, 'miss': 56, 'this': 57, 'chance': 58, 'double': 59, 'winnings': 60, 'click': 61, 'now': 62, 'exclusive': 63, 'deal': 64, 'alert': 65, 'save': 66, 'up': 67, '70': 68, 'select': 69, 'items': 70}
[[14, 1, 15, 16, 17, 18, 19, 20], [5, 21, 2, 22, 1, 23, 24, 25, 26, 27], [28, 6, 3, 1, 29, 1, 30, 7, 8, 31], [1, 32, 33, 7, 8, 34, 35], [9, 4, 1, 36, 37, 38, 39], [9, 6, 40, 41, 3, 10, 42, 43], [44, 11, 45, 12, 46, 11, 13, 47, 12, 48], [49, 50, 51, 4, 52, 53, 3, 10, 54, 55, 13], [5, 56, 57, 58, 2, 59, 1, 60, 61, 62], [63, 64, 65, 66, 67, 2, 68, 4, 69, 70]]
[[14  1 15 16 17 18 19 20  0  0  0]
 [ 5 21  2 22  1 23 24 25 26 27  0]
 [28  6  3  1 29  1 30  7  8 31  0]
 [ 1 32 33  7  8 34 35  0  0  0  0]
 [ 9  4  1 36 37 38 39  0  0  0  0]
 [ 9  6 40 41  3 10 42 43  0  0  0]
 [44 11 45 12 46 11 13 47 12 48  0]
 [49 50 51  4 52 53  3 10 54 55 13]
 [ 5 56 57 58  2 59  1 60 61 62  0]
 [63 64 65 66 67  2 68  4 69 70  0]]
70
11</code></pre>
</div>
</div>
<div id="cell-52" class="cell" data-outputid="559cb1fa-94d8-4bd1-f6c8-5011cd650b5a" data-execution_count="92">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple RNN model</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>model.add(Embedding(input_dim<span class="op">=</span><span class="bu">len</span>(tokenizer.word_index) <span class="op">+</span> <span class="dv">1</span>, output_dim<span class="op">=</span><span class="dv">10</span>, input_length<span class="op">=</span>X.shape[<span class="dv">1</span>]))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>model.add(SimpleRNN(<span class="dv">10</span>))</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train, epochs<span class="op">=</span><span class="dv">10</span>, batch_size<span class="op">=</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10
8/8 ━━━━━━━━━━━━━━━━━━━━ 3s 3ms/step - accuracy: 0.7053 - loss: 0.6814
Epoch 2/10
8/8 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 0.9156 - loss: 0.6509 
Epoch 3/10
8/8 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 1.0000 - loss: 0.5855 
Epoch 4/10
8/8 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 1.0000 - loss: 0.5241 
Epoch 5/10
8/8 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 1.0000 - loss: 0.4546 
Epoch 6/10
8/8 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 1.0000 - loss: 0.3736 
Epoch 7/10
8/8 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 1.0000 - loss: 0.3102 
Epoch 8/10
8/8 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 1.0000 - loss: 0.2188 
Epoch 9/10
8/8 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 1.0000 - loss: 0.1881 
Epoch 10/10
8/8 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 1.0000 - loss: 0.1459 </code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>&lt;keras.src.callbacks.history.History at 0x7ec762c747f0&gt;</code></pre>
</div>
</div>
<div id="cell-53" class="cell" data-outputid="e5cbdebd-40b4-45a7-f7ba-d4d2c125304b" data-execution_count="93">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluation and validation</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>loss, accuracy <span class="op">=</span> model.evaluate(X_test, y_test, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Test Accuracy: </span><span class="sc">{</span>accuracy <span class="op">*</span> <span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test Accuracy: 50.00%</code></pre>
</div>
</div>
<div id="cell-54" class="cell" data-outputid="e8fdeed4-9cc4-4677-b9ad-8a0c0aecc91a" data-execution_count="95">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction and Testing</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to classify mail to spam or not spam</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict_message(message):</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    tf.keras.backend.clear_session()     <span class="co"># Clear the TensorFlow session</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    message_seq <span class="op">=</span> tokenizer.texts_to_sequences([messages])     <span class="co"># Convert the message to numerical representation</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    max_length <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(seq) <span class="cf">for</span> seq <span class="kw">in</span> X)       <span class="co"># Pad sequences to a fixed length</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    message_seq <span class="op">=</span> pad_sequences(message_seq, maxlen<span class="op">=</span>max_length, padding<span class="op">=</span><span class="st">'post'</span>)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    message_seq <span class="op">=</span> np.array(message_seq)        <span class="co"># Convert to numpy array</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>    prediction <span class="op">=</span> model.predict(message_seq)[<span class="dv">0</span>][<span class="dv">0</span>]        <span class="co"># Make the prediction</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> <span class="st">'Non-Spam'</span> <span class="cf">if</span> prediction <span class="op">&gt;=</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'Spam'</span>        <span class="co"># Convert prediction to class label</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing with a random message</span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>random_message <span class="op">=</span> <span class="st">'You need to come to the office hours tomorrow'</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>predicted_label <span class="op">=</span> predict_message(random_message)</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The message classification for '</span><span class="sc">{</span>random_message<span class="sc">}</span><span class="ss">' is: </span><span class="sc">{</span>predicted_label<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 108ms/step
The message classification for 'You need to come to the office hours tomorrow' is: Non-Spam</code></pre>
</div>
</div>
</section>
<section id="sentiment-analysis" class="level2">
<h2 class="anchored" data-anchor-id="sentiment-analysis">Sentiment Analysis</h2>
</section>
<section id="analyzing-the-sentiment-based-on-textual-statements-using-natural-language-processing" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-the-sentiment-based-on-textual-statements-using-natural-language-processing">Analyzing the sentiment based on textual statements using Natural Language processing</h2>
<div id="cell-57" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sentiment Analysis</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>sentiment_message <span class="op">=</span> [</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'I love this product! It works really well.'</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'The customer service was terrible. I will never buy from this company again.'</span>,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'The movie was amazing. I highly recommend it to everyone.'</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'The food was awful. I wouldn</span><span class="ch">\'</span><span class="st">t eat here again even if it was free.'</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'I had a great experience with this service. I will definitely use it again.'</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'The product arrived damaged and the seller was unresponsive.'</span>,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'The book was disappointing. I expected more from the author.'</span>,</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'This restaurant never disappoints. The food is always delicious.'</span>,</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'The delivery was delayed and the package arrived damaged.'</span>,</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'The hotel room was dirty and the staff were rude.'</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Corresponding Sentiment Labels (0 for negative, 1 for positive):</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>labels_messages <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-58" class="cell" data-outputid="00badb96-934f-4aef-dc03-470616570e0a" data-execution_count="65">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Preprocessing</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Convert names to numerical representation</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> Tokenizer(char_level<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>tokenizer.fit_on_texts(sentiment_message)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Vocabulary:"</span>, tokenizer.word_index)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> tokenizer.texts_to_sequences(sentiment_message)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Pad sequences to a fixed length</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>max_length <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(seq) <span class="cf">for</span> seq <span class="kw">in</span> X)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pad_sequences(X, maxlen<span class="op">=</span>max_length, padding<span class="op">=</span><span class="st">'post'</span>)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(X)    <span class="co"># Convert to numpy array</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. One-hot encode genders</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array(labels_messages)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Split dataset into training and testing sets</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(tokenizer.word_index))</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.shape[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Vocabulary: {'the': 1, 'was': 2, 'i': 3, 'this': 4, 'it': 5, 'again': 6, 'and': 7, 'product': 8, 'service': 9, 'will': 10, 'never': 11, 'from': 12, 'food': 13, 'arrived': 14, 'damaged': 15, 'love': 16, 'works': 17, 'really': 18, 'well': 19, 'customer': 20, 'terrible': 21, 'buy': 22, 'company': 23, 'movie': 24, 'amazing': 25, 'highly': 26, 'recommend': 27, 'to': 28, 'everyone': 29, 'awful': 30, "wouldn't": 31, 'eat': 32, 'here': 33, 'even': 34, 'if': 35, 'free': 36, 'had': 37, 'a': 38, 'great': 39, 'experience': 40, 'with': 41, 'definitely': 42, 'use': 43, 'seller': 44, 'unresponsive': 45, 'book': 46, 'disappointing': 47, 'expected': 48, 'more': 49, 'author': 50, 'restaurant': 51, 'disappoints': 52, 'is': 53, 'always': 54, 'delicious': 55, 'delivery': 56, 'delayed': 57, 'package': 58, 'hotel': 59, 'room': 60, 'dirty': 61, 'staff': 62, 'were': 63, 'rude': 64}
[[3, 16, 4, 8, 5, 17, 18, 19], [1, 20, 9, 2, 21, 3, 10, 11, 22, 12, 4, 23, 6], [1, 24, 2, 25, 3, 26, 27, 5, 28, 29], [1, 13, 2, 30, 3, 31, 32, 33, 6, 34, 35, 5, 2, 36], [3, 37, 38, 39, 40, 41, 4, 9, 3, 10, 42, 43, 5, 6], [1, 8, 14, 15, 7, 1, 44, 2, 45], [1, 46, 2, 47, 3, 48, 49, 12, 1, 50], [4, 51, 11, 52, 1, 13, 53, 54, 55], [1, 56, 2, 57, 7, 1, 58, 14, 15], [1, 59, 60, 2, 61, 7, 1, 62, 63, 64]]
[[ 3 16  4  8  5 17 18 19  0  0  0  0  0  0]
 [ 1 20  9  2 21  3 10 11 22 12  4 23  6  0]
 [ 1 24  2 25  3 26 27  5 28 29  0  0  0  0]
 [ 1 13  2 30  3 31 32 33  6 34 35  5  2 36]
 [ 3 37 38 39 40 41  4  9  3 10 42 43  5  6]
 [ 1  8 14 15  7  1 44  2 45  0  0  0  0  0]
 [ 1 46  2 47  3 48 49 12  1 50  0  0  0  0]
 [ 4 51 11 52  1 13 53 54 55  0  0  0  0  0]
 [ 1 56  2 57  7  1 58 14 15  0  0  0  0  0]
 [ 1 59 60  2 61  7  1 62 63 64  0  0  0  0]]
64
14</code></pre>
</div>
</div>
<div id="cell-59" class="cell" data-outputid="f40b0c29-96e3-4e5f-f700-498ced27993c" data-execution_count="66">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple RNN model</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>model.add(Embedding(input_dim<span class="op">=</span><span class="bu">len</span>(tokenizer.word_index) <span class="op">+</span> <span class="dv">1</span>, output_dim<span class="op">=</span><span class="dv">10</span>, input_length<span class="op">=</span>X.shape[<span class="dv">1</span>]))</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>model.add(SimpleRNN(<span class="dv">10</span>))</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>))</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train, epochs<span class="op">=</span><span class="dv">2</span>, batch_size<span class="op">=</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/2
8/8 ━━━━━━━━━━━━━━━━━━━━ 2s 4ms/step - accuracy: 0.8942 - loss: 0.6653
Epoch 2/2
8/8 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 0.7108 - loss: 0.6371 </code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>&lt;keras.src.callbacks.history.History at 0x7ec76c3c78b0&gt;</code></pre>
</div>
</div>
<div id="cell-60" class="cell" data-outputid="afabfe7f-c9fd-4dc6-b043-f719254a6043" data-execution_count="67">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluation and validation</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>loss, accuracy <span class="op">=</span> model.evaluate(X_test, y_test, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Test Accuracy: </span><span class="sc">{</span>accuracy <span class="op">*</span> <span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test Accuracy: 100.00%</code></pre>
</div>
</div>
<div id="cell-61" class="cell" data-outputid="13cbd30c-5ced-4a37-97fd-263070505f21" data-execution_count="68">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction and Testing</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to perform sentiment analysis</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict_sentiment_message(sentiment_message):</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    tf.keras.backend.clear_session()     <span class="co"># Clear the TensorFlow session</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    message_seq <span class="op">=</span> tokenizer.texts_to_sequences([sentiment_message])     <span class="co"># Convert the message to numerical representation</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    max_length <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(seq) <span class="cf">for</span> seq <span class="kw">in</span> X)       <span class="co"># Pad sequences to a fixed length</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    message_seq <span class="op">=</span> pad_sequences(message_seq, maxlen<span class="op">=</span>max_length, padding<span class="op">=</span><span class="st">'post'</span>)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    message_seq <span class="op">=</span> np.array(message_seq)        <span class="co"># Convert to numpy array</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>    prediction <span class="op">=</span> model.predict(message_seq)[<span class="dv">0</span>][<span class="dv">0</span>]        <span class="co"># Make the prediction</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> <span class="st">'Positive'</span> <span class="cf">if</span> prediction <span class="op">&gt;=</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">'Negative'</span>     <span class="co"># Convert prediction to class label</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing with a random message</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>random_message <span class="op">=</span> <span class="st">'I love this product! It works really well.'</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>predicted_label <span class="op">=</span> predict_message(random_message)</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The message classification for '</span><span class="sc">{</span>random_message<span class="sc">}</span><span class="ss">' is: </span><span class="sc">{</span>predicted_label<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>WARNING:tensorflow:5 out of the last 16 calls to &lt;function TensorFlowTrainer.make_predict_function.&lt;locals&gt;.one_step_on_data_distributed at 0x7ec761711090&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 265ms/step
The message classification for 'I love this product! It works really well.' is: Non-Spam</code></pre>
</div>
</div>
</section>
</section>
<section id="module-3---next-word-prediction" class="level1">
<h1>Module 3 - Next Word Prediction</h1>
<section id="predicting-the-next-word-based-on-incomplete-sentences" class="level2">
<h2 class="anchored" data-anchor-id="predicting-the-next-word-based-on-incomplete-sentences">Predicting the next word based on incomplete sentences</h2>
<div id="cell-64" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.text <span class="im">import</span> Tokenizer</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.sequence <span class="im">import</span> pad_sequences</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Embedding, LSTM, Dense</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"/content/IndiaUS.txt"</span>) <span class="im">as</span> myfile:</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    mytext <span class="op">=</span> myfile.read()  <span class="co"># Read the entire text file as a string</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-65" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Preprocessing</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Convert names to numerical representation</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> Tokenizer()</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>tokenizer.fit_on_texts([mytext])</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>num_classes <span class="op">=</span> <span class="bu">len</span>(tokenizer.word_index) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>input_sequences <span class="op">=</span> []</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> mytext.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>):</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    token_list <span class="op">=</span> tokenizer.texts_to_sequences([line])[<span class="dv">0</span>]</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(token_list)):</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>        input_sequences.append(token_list[:i<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Pad sequences to a fixed length</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>maxlen <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(seq) <span class="cf">for</span> seq <span class="kw">in</span> input_sequences)</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>input_sequences <span class="op">=</span> np.array(pad_sequences(input_sequences, maxlen<span class="op">=</span>maxlen, padding<span class="op">=</span><span class="st">'pre'</span>))</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print(input_sequences)</span></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. x, y</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> input_sequences[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> input_sequences[:, <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array(tf.keras.utils.to_categorical(y, num_classes<span class="op">=</span>num_classes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-66" class="cell" data-outputid="7dbb663d-64ac-4cb6-ac11-229b6b5d3d9c" data-execution_count="75">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LSTM Model</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>model.add(Embedding(num_classes, <span class="dv">100</span>, input_length<span class="op">=</span>maxlen<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>model.add(LSTM(<span class="dv">150</span>))</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>model.add(Dense(num_classes, activation<span class="op">=</span><span class="st">'softmax'</span>))</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'categorical_crossentropy'</span>, optimizer<span class="op">=</span><span class="st">'adam'</span>, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>model.fit(X, y, epochs<span class="op">=</span><span class="dv">59</span>, verbose<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/59</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>43/43 ━━━━━━━━━━━━━━━━━━━━ 4s 9ms/step - accuracy: 0.0434 - loss: 6.2712
Epoch 2/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.0426 - loss: 5.8116
Epoch 3/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.0640 - loss: 5.7218
Epoch 4/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.0536 - loss: 5.6789
Epoch 5/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.0530 - loss: 5.5070
Epoch 6/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.0474 - loss: 5.5270
Epoch 7/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.0552 - loss: 5.3251
Epoch 8/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.0725 - loss: 5.1749
Epoch 9/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.1029 - loss: 4.9420
Epoch 10/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.1180 - loss: 4.6287
Epoch 11/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.1448 - loss: 4.4686
Epoch 12/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.1602 - loss: 4.2695
Epoch 13/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.1679 - loss: 4.0743
Epoch 14/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.1985 - loss: 3.8813
Epoch 15/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.2411 - loss: 3.5732
Epoch 16/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.2738 - loss: 3.4481
Epoch 17/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 6ms/step - accuracy: 0.2981 - loss: 3.2945
Epoch 18/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.3328 - loss: 3.0863
Epoch 19/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.4257 - loss: 2.8350
Epoch 20/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.4556 - loss: 2.6780
Epoch 21/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.5218 - loss: 2.4800
Epoch 22/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.5512 - loss: 2.3449
Epoch 23/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 9ms/step - accuracy: 0.6374 - loss: 2.1380
Epoch 24/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 9ms/step - accuracy: 0.6626 - loss: 2.0485
Epoch 25/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 21ms/step - accuracy: 0.7119 - loss: 1.8379
Epoch 26/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - accuracy: 0.7575 - loss: 1.7240
Epoch 27/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7941 - loss: 1.6087
Epoch 28/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 11ms/step - accuracy: 0.8181 - loss: 1.4396
Epoch 29/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.8378 - loss: 1.3609
Epoch 30/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.8785 - loss: 1.2069
Epoch 31/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.8946 - loss: 1.1226
Epoch 32/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9098 - loss: 1.0002
Epoch 33/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.9241 - loss: 0.9355
Epoch 34/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9325 - loss: 0.8460
Epoch 35/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9494 - loss: 0.7949
Epoch 36/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.9488 - loss: 0.7151
Epoch 37/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9622 - loss: 0.6858
Epoch 38/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9574 - loss: 0.6278
Epoch 39/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9700 - loss: 0.5628
Epoch 40/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.9721 - loss: 0.5222
Epoch 41/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9770 - loss: 0.4805
Epoch 42/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9673 - loss: 0.4651
Epoch 43/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9865 - loss: 0.3991
Epoch 44/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9820 - loss: 0.4012
Epoch 45/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9807 - loss: 0.3743
Epoch 46/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9760 - loss: 0.3526
Epoch 47/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9878 - loss: 0.3031
Epoch 48/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.9829 - loss: 0.3111
Epoch 49/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9825 - loss: 0.2679
Epoch 50/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9842 - loss: 0.2641
Epoch 51/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9846 - loss: 0.2532
Epoch 52/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9844 - loss: 0.2373
Epoch 53/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9840 - loss: 0.2185
Epoch 54/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9810 - loss: 0.2138
Epoch 55/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 9ms/step - accuracy: 0.9851 - loss: 0.2074
Epoch 56/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - accuracy: 0.9857 - loss: 0.1962
Epoch 57/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step - accuracy: 0.9864 - loss: 0.1768
Epoch 58/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 10ms/step - accuracy: 0.9911 - loss: 0.1642
Epoch 59/59
43/43 ━━━━━━━━━━━━━━━━━━━━ 1s 10ms/step - accuracy: 0.9911 - loss: 0.1563</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>&lt;keras.src.callbacks.history.History at 0x7ec76156acb0&gt;</code></pre>
</div>
</div>
<div id="cell-67" class="cell" data-outputid="8d8c9ac8-3529-4366-dcaa-ae4ecb3ba2f3" data-execution_count="76">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>input_text <span class="op">=</span> <span class="st">"Joe biden"</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>next_words <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(next_words):</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    token_list <span class="op">=</span> tokenizer.texts_to_sequences([input_text])[<span class="dv">0</span>]</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    token_list <span class="op">=</span> pad_sequences([token_list], maxlen<span class="op">=</span>maxlen<span class="op">-</span><span class="dv">1</span>, padding<span class="op">=</span><span class="st">'pre'</span>)</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    predicted <span class="op">=</span> np.argmax(model.predict(token_list), axis<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    output_word <span class="op">=</span> <span class="st">""</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word, index <span class="kw">in</span> tokenizer.word_index.items():</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> index <span class="op">==</span> predicted:</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>            output_word <span class="op">=</span> word</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    input_text <span class="op">+=</span> <span class="st">" "</span> <span class="op">+</span> output_word</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(input_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 172ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 17ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 16ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 16ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 16ms/step
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 16ms/step
Joe biden and indian prime minister narendra modi</code></pre>
</div>
</div>
</section>
</section>
<section id="module-4---q-learning" class="level1">
<h1>Module 4 - Q Learning</h1>
<section id="implementation-of-q-learning-a-reinforcement-learning-algorithm-to-train-an-agent-to-navigate-through-a-grid-based-environment-and-reach-a-goal-state-while-avoiding-obstacle" class="level2">
<h2 class="anchored" data-anchor-id="implementation-of-q-learning-a-reinforcement-learning-algorithm-to-train-an-agent-to-navigate-through-a-grid-based-environment-and-reach-a-goal-state-while-avoiding-obstacle">Implementation of Q-learning, a reinforcement learning algorithm, to train an agent to navigate through a grid-based environment and reach a goal state while avoiding obstacle</h2>
<div id="cell-70" class="cell" data-outputid="4cf95f24-0675-45c3-8d02-fc487402912a" data-execution_count="82">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the environment</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>environment <span class="op">=</span> np.array([</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>]</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define parameters</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>num_states <span class="op">=</span> np.prod(environment.shape)</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>num_actions <span class="op">=</span> <span class="dv">4</span>  <span class="co"># up, down, left, right</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>learning_rate <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> <span class="fl">0.9</span>  <span class="co"># discount factor</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>epsilon <span class="op">=</span> <span class="fl">0.1</span>  <span class="co"># exploration rate</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>num_episodes <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize Q-table</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> np.zeros((num_states, num_actions))</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 2D coordinates to 1D index</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> state_to_index(state):</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> state[<span class="dv">0</span>] <span class="op">*</span> environment.shape[<span class="dv">1</span>] <span class="op">+</span> state[<span class="dv">1</span>]</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 1D index to 2D coordinates</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> index_to_state(index):</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (index <span class="op">//</span> environment.shape[<span class="dv">1</span>], index <span class="op">%</span> environment.shape[<span class="dv">1</span>])</span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose action using epsilon-greedy policy</span></span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> choose_action(state):</span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> np.random.rand() <span class="op">&lt;</span> epsilon:</span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.random.randint(num_actions)  <span class="co"># random action</span></span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.argmax(Q[state_to_index(state)])  <span class="co"># greedy action</span></span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Q-learning</span></span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> episode <span class="kw">in</span> <span class="bu">range</span>(num_episodes):</span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> (<span class="dv">4</span>, <span class="dv">0</span>)  <span class="co"># starting state</span></span>
<span id="cb98-39"><a href="#cb98-39" aria-hidden="true" tabindex="-1"></a>    done <span class="op">=</span> <span class="va">False</span></span>
<span id="cb98-40"><a href="#cb98-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> done:</span>
<span id="cb98-41"><a href="#cb98-41" aria-hidden="true" tabindex="-1"></a>        action <span class="op">=</span> choose_action(state)</span>
<span id="cb98-42"><a href="#cb98-42" aria-hidden="true" tabindex="-1"></a>        next_state <span class="op">=</span> state</span>
<span id="cb98-43"><a href="#cb98-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-44"><a href="#cb98-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Move agent to next state</span></span>
<span id="cb98-45"><a href="#cb98-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> action <span class="op">==</span> <span class="dv">0</span>:  <span class="co"># up</span></span>
<span id="cb98-46"><a href="#cb98-46" aria-hidden="true" tabindex="-1"></a>            next_state <span class="op">=</span> (<span class="bu">max</span>(state[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>, <span class="dv">0</span>), state[<span class="dv">1</span>])</span>
<span id="cb98-47"><a href="#cb98-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> action <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># down</span></span>
<span id="cb98-48"><a href="#cb98-48" aria-hidden="true" tabindex="-1"></a>            next_state <span class="op">=</span> (<span class="bu">min</span>(state[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, environment.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>), state[<span class="dv">1</span>])</span>
<span id="cb98-49"><a href="#cb98-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> action <span class="op">==</span> <span class="dv">2</span>:  <span class="co"># left</span></span>
<span id="cb98-50"><a href="#cb98-50" aria-hidden="true" tabindex="-1"></a>            next_state <span class="op">=</span> (state[<span class="dv">0</span>], <span class="bu">max</span>(state[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb98-51"><a href="#cb98-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> action <span class="op">==</span> <span class="dv">3</span>:  <span class="co"># right</span></span>
<span id="cb98-52"><a href="#cb98-52" aria-hidden="true" tabindex="-1"></a>            next_state <span class="op">=</span> (state[<span class="dv">0</span>], <span class="bu">min</span>(state[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>, environment.shape[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb98-53"><a href="#cb98-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-54"><a href="#cb98-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reward</span></span>
<span id="cb98-55"><a href="#cb98-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> environment[next_state[<span class="dv">0</span>], next_state[<span class="dv">1</span>]] <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># obstacle</span></span>
<span id="cb98-56"><a href="#cb98-56" aria-hidden="true" tabindex="-1"></a>            reward <span class="op">=</span> <span class="op">-</span><span class="dv">100</span></span>
<span id="cb98-57"><a href="#cb98-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> environment[next_state[<span class="dv">0</span>], next_state[<span class="dv">1</span>]] <span class="op">==</span> <span class="dv">3</span>:  <span class="co"># goal</span></span>
<span id="cb98-58"><a href="#cb98-58" aria-hidden="true" tabindex="-1"></a>            reward <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb98-59"><a href="#cb98-59" aria-hidden="true" tabindex="-1"></a>            done <span class="op">=</span> <span class="va">True</span></span>
<span id="cb98-60"><a href="#cb98-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb98-61"><a href="#cb98-61" aria-hidden="true" tabindex="-1"></a>            reward <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>  <span class="co"># default penalty</span></span>
<span id="cb98-62"><a href="#cb98-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-63"><a href="#cb98-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update Q-value</span></span>
<span id="cb98-64"><a href="#cb98-64" aria-hidden="true" tabindex="-1"></a>        Q[state_to_index(state), action] <span class="op">+=</span> learning_rate <span class="op">*</span> (</span>
<span id="cb98-65"><a href="#cb98-65" aria-hidden="true" tabindex="-1"></a>            reward <span class="op">+</span> gamma <span class="op">*</span> np.<span class="bu">max</span>(Q[state_to_index(next_state)]) <span class="op">-</span> Q[state_to_index(state), action]</span>
<span id="cb98-66"><a href="#cb98-66" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb98-67"><a href="#cb98-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-68"><a href="#cb98-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Move to next state</span></span>
<span id="cb98-69"><a href="#cb98-69" aria-hidden="true" tabindex="-1"></a>        state <span class="op">=</span> next_state</span>
<span id="cb98-70"><a href="#cb98-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-71"><a href="#cb98-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Print learned Q-values</span></span>
<span id="cb98-72"><a href="#cb98-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Learned Q-values:"</span>)</span>
<span id="cb98-73"><a href="#cb98-73" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Learned Q-values:
[[-6.79346521e-01 -1.90090000e+01 -6.79346521e-01 -6.88191453e-01]
 [-6.79346521e-01 -1.00000000e+01 -6.81950582e-01 -7.70867490e-01]
 [-7.72553056e-01 -1.90000000e+01 -7.65391267e-01 -8.06016741e-01]
 [-8.57201536e-01 -1.00000000e+01 -8.15391558e-01 -8.97164524e-01]
 [-9.52191035e-01 -9.77591284e-01 -9.03957593e-01 -9.56179250e-01]
 [-1.90000000e-01 -2.07910000e-01 -1.00000000e+01 -1.00000000e+01]
 [-1.00000000e-01 -1.19368000e-01 -1.00000000e+01 -1.00000000e+01]
 [-1.00000000e-01 -1.90000000e-01 -1.00000000e+01 -1.00000000e+01]
 [-1.00000000e-01 -1.00000000e-01 -1.00000000e+01 -1.44108955e-01]
 [-9.79090783e-01 -9.96952232e-01 -1.00000000e+01 -9.56179250e-01]
 [-1.90000000e+01 -1.02284816e+00 -9.55704705e-01 -9.67029822e-01]
 [-1.00000000e+01 -1.00000000e+01 -1.04286175e+00 -9.54645627e-01]
 [-1.00000000e+01 -1.00000000e+01 -1.03186229e+00 -9.77493096e-01]
 [-1.00000000e+01 -1.00000000e+01 -1.00790737e+00 -9.82914927e-01]
 [-9.76515510e-01 -1.00000000e+01 -1.01033629e+00 -9.56179250e-01]
 [-9.10646767e-01 -9.39216466e-01 -8.64827525e-01 -1.00000000e+01]
 [-1.00000000e-01 -1.00000000e-01 -1.09000000e-01 -1.00000000e+01]
 [-2.45717398e-01 -1.00000000e-01 -1.00000000e+01  0.00000000e+00]
 [-1.00000000e-01 -1.00000000e-01 -1.00000000e+01  0.00000000e+00]
 [-1.00000000e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [-8.23988365e-01 -7.72553056e-01 -7.72553056e-01  5.16616042e-02]
 [-1.00000000e+01 -3.94039900e-01 -4.37597723e-01  5.67878087e+00]
 [-1.00000000e+01  1.89840910e+00 -1.99810000e-01  2.73986313e+01]
 [-1.90000000e+01 -1.00000000e-01  2.00044157e+00  6.51321560e+01]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]]</code></pre>
</div>
</div>
</section>
</section>
<section id="module-5---autoencoders" class="level1">
<h1>Module 5 - Autoencoders</h1>
<section id="vanilla" class="level2">
<h2 class="anchored" data-anchor-id="vanilla">Vanilla</h2>
</section>
<section id="implementation-of-a-vanilla-autoencoder-using-keras-to-compress-and-reconstruct-images-from-the-mnist-dataset-which-contains-grayscale-images-of-handwritten-digits." class="level2">
<h2 class="anchored" data-anchor-id="implementation-of-a-vanilla-autoencoder-using-keras-to-compress-and-reconstruct-images-from-the-mnist-dataset-which-contains-grayscale-images-of-handwritten-digits.">Implementation of a vanilla autoencoder using Keras to compress and reconstruct images from the MNIST dataset, which contains grayscale images of handwritten digits.</h2>
<div id="cell-74" class="cell" data-outputid="1e971f78-4af5-4ede-b691-1f0d32f55276" data-execution_count="83">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Model</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense, Input</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.datasets <span class="im">import</span> mnist</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load MNIST Dataset</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>(x_train, _), (x_test, _) <span class="op">=</span> mnist.load_data()</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> x_train <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> x_test <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> x_train.reshape((<span class="bu">len</span>(x_train), np.prod(x_train.shape[<span class="dv">1</span>:])))</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> x_test.reshape((<span class="bu">len</span>(x_test), np.prod(x_test.shape[<span class="dv">1</span>:])))</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Hyperparameters</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>epochs <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>input_dim <span class="op">=</span> <span class="dv">784</span>  <span class="co"># 28x28 images flattened</span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>encoding_dim <span class="op">=</span> <span class="dv">16</span>  <span class="co"># Number of units in the bottleneck layer</span></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Build autoencoder model</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>input_img <span class="op">=</span> Input(shape<span class="op">=</span>(input_dim,))</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>encoded <span class="op">=</span> Dense(encoding_dim, activation<span class="op">=</span><span class="st">'relu'</span>)(input_img)</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>decoded <span class="op">=</span> Dense(input_dim, activation<span class="op">=</span><span class="st">'sigmoid'</span>)(encoded)</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>autoencoder <span class="op">=</span> Model(input_img, decoded)</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Compile the model</span></span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>autoencoder.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>)</span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a>autoencoder.fit(x_train, x_train, epochs<span class="op">=</span>epochs, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>, validation_data<span class="op">=</span>(x_test, x_test))</span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>evaluation <span class="op">=</span> autoencoder.evaluate(x_test, x_test, batch_size<span class="op">=</span>batch_size, verbose<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">Summary: Loss over the test dataset: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> (evaluation))</span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-36"><a href="#cb100-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the reconstructed images</span></span>
<span id="cb100-37"><a href="#cb100-37" aria-hidden="true" tabindex="-1"></a><span class="co"># decoded_imgs = autoencoder.predict(x_test)</span></span>
<span id="cb100-38"><a href="#cb100-38" aria-hidden="true" tabindex="-1"></a><span class="co"># n = 10</span></span>
<span id="cb100-39"><a href="#cb100-39" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.figure(figsize=(20, 4))</span></span>
<span id="cb100-40"><a href="#cb100-40" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(n):</span></span>
<span id="cb100-41"><a href="#cb100-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax = plt.subplot(2, n, i + 1)</span></span>
<span id="cb100-42"><a href="#cb100-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.imshow(x_test[i].reshape(28, 28))</span></span>
<span id="cb100-43"><a href="#cb100-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.gray()</span></span>
<span id="cb100-44"><a href="#cb100-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_xaxis().set_visible(False)</span></span>
<span id="cb100-45"><a href="#cb100-45" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_yaxis().set_visible(False)</span></span>
<span id="cb100-46"><a href="#cb100-46" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax = plt.subplot(2, n, i + 1 + n)</span></span>
<span id="cb100-47"><a href="#cb100-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.imshow(decoded_imgs[i].reshape(28, 28))</span></span>
<span id="cb100-48"><a href="#cb100-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.gray()</span></span>
<span id="cb100-49"><a href="#cb100-49" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_xaxis().set_visible(False)</span></span>
<span id="cb100-50"><a href="#cb100-50" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_yaxis().set_visible(False)</span></span>
<span id="cb100-51"><a href="#cb100-51" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - loss: 0.3471</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>WARNING:tensorflow:5 out of the last 166 calls to &lt;function TensorFlowTrainer.make_test_function.&lt;locals&gt;.one_step_on_iterator at 0x7ec765f09cf0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>469/469 ━━━━━━━━━━━━━━━━━━━━ 3s 4ms/step - loss: 0.3469 - val_loss: 0.1847
Epoch 2/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 3s 2ms/step - loss: 0.1764 - val_loss: 0.1544
Epoch 3/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 1s 2ms/step - loss: 0.1516 - val_loss: 0.1425
Epoch 4/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 1s 2ms/step - loss: 0.1420 - val_loss: 0.1380
Epoch 5/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 1s 2ms/step - loss: 0.1384 - val_loss: 0.1348
79/79 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - loss: 0.1352

Summary: Loss over the test dataset: 0.13</code></pre>
</div>
</div>
</section>
<section id="sparse" class="level2">
<h2 class="anchored" data-anchor-id="sparse">Sparse</h2>
</section>
<section id="this-sparse-autoencoder-demonstrates-how-to-enforce-sparsity-in-the-hidden-layer-while-learning-compact-representations-of-data.-it-successfully-reconstructs-images-from-their-compressed-representations-making-it-a-powerful-tool-for-dimensionality-reduction-and-feature-learning" class="level2">
<h2 class="anchored" data-anchor-id="this-sparse-autoencoder-demonstrates-how-to-enforce-sparsity-in-the-hidden-layer-while-learning-compact-representations-of-data.-it-successfully-reconstructs-images-from-their-compressed-representations-making-it-a-powerful-tool-for-dimensionality-reduction-and-feature-learning">This sparse autoencoder demonstrates how to enforce sparsity in the hidden layer while learning compact representations of data. It successfully reconstructs images from their compressed representations, making it a powerful tool for dimensionality reduction and feature learning</h2>
<div id="cell-77" class="cell" data-outputid="29fbf662-bafe-4f62-ffae-b3e1c619dbb0" data-execution_count="84">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras <span class="im">import</span> regularizers</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Model</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense, Input</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.datasets <span class="im">import</span> mnist</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load MNIST Dataset</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>(x_train, _), (x_test, _) <span class="op">=</span> mnist.load_data()</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> x_train <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> x_test <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> x_train.reshape((<span class="bu">len</span>(x_train), np.prod(x_train.shape[<span class="dv">1</span>:])))</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> x_test.reshape((<span class="bu">len</span>(x_test), np.prod(x_test.shape[<span class="dv">1</span>:])))</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_train.shape)</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_test.shape)</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Hyperparameters</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>nb_epoch <span class="op">=</span> <span class="dv">5</span>  <span class="co"># Increase epochs for better training</span></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>nb_visible <span class="op">=</span> <span class="dv">784</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>nb_hidden <span class="op">=</span> <span class="dv">1024</span>  <span class="co"># Number of hidden nodes</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Build sparse autoencoder model</span></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>input_img <span class="op">=</span> Input(shape<span class="op">=</span>(nb_visible,))</span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>encoded <span class="op">=</span> Dense(nb_hidden, activation<span class="op">=</span><span class="st">'relu'</span>, activity_regularizer<span class="op">=</span>regularizers.l1(<span class="fl">10e-5</span>))(input_img)</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>decoded <span class="op">=</span> Dense(nb_visible, activation<span class="op">=</span><span class="st">'sigmoid'</span>)(encoded)</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>autoencoder <span class="op">=</span> Model(input_img, decoded)</span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>autoencoder.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'Adam'</span>, loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>)</span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>autoencoder.fit(x_train, x_train, epochs<span class="op">=</span>nb_epoch, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>, validation_data<span class="op">=</span>(x_test, x_test))</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>evaluation <span class="op">=</span> autoencoder.evaluate(x_test, x_test, batch_size<span class="op">=</span>batch_size, verbose<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">Summary: Loss over the test dataset: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> (evaluation))</span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Decode test images</span></span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a><span class="co"># decoded_imgs = autoencoder.predict(x_test)</span></span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a><span class="co"># n = 10  # Number of digits to display</span></span>
<span id="cb104-40"><a href="#cb104-40" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.figure(figsize=(20, 4))</span></span>
<span id="cb104-41"><a href="#cb104-41" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(n):</span></span>
<span id="cb104-42"><a href="#cb104-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Display original</span></span>
<span id="cb104-43"><a href="#cb104-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax = plt.subplot(2, n, i + 1)</span></span>
<span id="cb104-44"><a href="#cb104-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.imshow(x_test[i].reshape(28, 28))</span></span>
<span id="cb104-45"><a href="#cb104-45" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.gray()</span></span>
<span id="cb104-46"><a href="#cb104-46" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_xaxis().set_visible(False)</span></span>
<span id="cb104-47"><a href="#cb104-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_yaxis().set_visible(False)</span></span>
<span id="cb104-48"><a href="#cb104-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Display reconstruction</span></span>
<span id="cb104-49"><a href="#cb104-49" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax = plt.subplot(2, n, i + 1 + n)</span></span>
<span id="cb104-50"><a href="#cb104-50" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.imshow(decoded_imgs[i].reshape(28, 28))</span></span>
<span id="cb104-51"><a href="#cb104-51" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.gray()</span></span>
<span id="cb104-52"><a href="#cb104-52" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_xaxis().set_visible(False)</span></span>
<span id="cb104-53"><a href="#cb104-53" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_yaxis().set_visible(False)</span></span>
<span id="cb104-54"><a href="#cb104-54" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span>
<span id="cb104-55"><a href="#cb104-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-56"><a href="#cb104-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the hidden layer weights</span></span>
<span id="cb104-57"><a href="#cb104-57" aria-hidden="true" tabindex="-1"></a><span class="co"># w = []</span></span>
<span id="cb104-58"><a href="#cb104-58" aria-hidden="true" tabindex="-1"></a><span class="co"># for layer in autoencoder.layers:</span></span>
<span id="cb104-59"><a href="#cb104-59" aria-hidden="true" tabindex="-1"></a><span class="co">#     weights = layer.get_weights()</span></span>
<span id="cb104-60"><a href="#cb104-60" aria-hidden="true" tabindex="-1"></a><span class="co">#     w.append(weights)</span></span>
<span id="cb104-61"><a href="#cb104-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-62"><a href="#cb104-62" aria-hidden="true" tabindex="-1"></a><span class="co"># nb_show = 1024  # Show first 1024 nodes in hidden layer</span></span>
<span id="cb104-63"><a href="#cb104-63" aria-hidden="true" tabindex="-1"></a><span class="co"># layer = np.array(w[1][0])</span></span>
<span id="cb104-64"><a href="#cb104-64" aria-hidden="true" tabindex="-1"></a><span class="co"># layer1 = layer[:, 0:nb_show]</span></span>
<span id="cb104-65"><a href="#cb104-65" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Shape of Hidden Layer", layer1.shape)</span></span>
<span id="cb104-66"><a href="#cb104-66" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Visualization of first", nb_show, "nodes in the Hidden Layer")</span></span>
<span id="cb104-67"><a href="#cb104-67" aria-hidden="true" tabindex="-1"></a><span class="co"># fig = plt.figure(figsize=(20, 20))</span></span>
<span id="cb104-68"><a href="#cb104-68" aria-hidden="true" tabindex="-1"></a><span class="co"># columns = 8</span></span>
<span id="cb104-69"><a href="#cb104-69" aria-hidden="true" tabindex="-1"></a><span class="co"># rows = int(nb_show / 8)</span></span>
<span id="cb104-70"><a href="#cb104-70" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(1, columns * rows + 1):</span></span>
<span id="cb104-71"><a href="#cb104-71" aria-hidden="true" tabindex="-1"></a><span class="co">#     fig.add_subplot(rows, columns, i)</span></span>
<span id="cb104-72"><a href="#cb104-72" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.imshow(layer1[:, i - 1].reshape(28, 28), cmap='gray')</span></span>
<span id="cb104-73"><a href="#cb104-73" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(60000, 784)
(10000, 784)
Epoch 1/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 4s 5ms/step - loss: 0.7019 - val_loss: 0.5536
Epoch 2/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 4s 4ms/step - loss: 0.5281 - val_loss: 0.4640
Epoch 3/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 1s 3ms/step - loss: 0.4472 - val_loss: 0.4053
Epoch 4/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 1s 3ms/step - loss: 0.3941 - val_loss: 0.3658
Epoch 5/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 1s 2ms/step - loss: 0.3581 - val_loss: 0.3387
79/79 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - loss: 0.3340

Summary: Loss over the test dataset: 0.34</code></pre>
</div>
</div>
</section>
<section id="deep" class="level2">
<h2 class="anchored" data-anchor-id="deep">Deep</h2>
</section>
<section id="implementation-of-a-deep-autoencoder-using-keras-to-compress-and-reconstruct-images-from-the-mnist-dataset" class="level2">
<h2 class="anchored" data-anchor-id="implementation-of-a-deep-autoencoder-using-keras-to-compress-and-reconstruct-images-from-the-mnist-dataset">Implementation of a deep autoencoder using Keras to compress and reconstruct images from the MNIST dataset</h2>
<div id="cell-80" class="cell" data-outputid="5b67da18-de3e-4a6b-b441-88228f760d3e" data-execution_count="85">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Model</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense, Input</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.datasets <span class="im">import</span> mnist</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load MNIST Dataset</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>(x_train, _), (x_test, _) <span class="op">=</span> mnist.load_data()</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> x_train <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> x_test <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> x_train.reshape((<span class="bu">len</span>(x_train), np.prod(x_train.shape[<span class="dv">1</span>:])))</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> x_test.reshape((<span class="bu">len</span>(x_test), np.prod(x_test.shape[<span class="dv">1</span>:])))</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_train.shape)</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_test.shape)</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Hyperparameters</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>nb_epoch <span class="op">=</span> <span class="dv">5</span>  <span class="co"># Increase epochs for better training</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>nb_visible <span class="op">=</span> <span class="dv">784</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>encoding_dim <span class="op">=</span> <span class="dv">64</span>  <span class="co"># Compressed representation</span></span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Build deep autoencoder model</span></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>input_img <span class="op">=</span> Input(shape<span class="op">=</span>(nb_visible,))</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>encoded <span class="op">=</span> Dense(<span class="dv">512</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(input_img)</span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>encoded <span class="op">=</span> Dense(<span class="dv">256</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(encoded)</span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>encoded <span class="op">=</span> Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(encoded)</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>encoded <span class="op">=</span> Dense(encoding_dim, activation<span class="op">=</span><span class="st">'relu'</span>)(encoded)</span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>decoded <span class="op">=</span> Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(encoded)</span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>decoded <span class="op">=</span> Dense(<span class="dv">256</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(decoded)</span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>decoded <span class="op">=</span> Dense(<span class="dv">512</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(decoded)</span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a>decoded <span class="op">=</span> Dense(nb_visible, activation<span class="op">=</span><span class="st">'sigmoid'</span>)(decoded)</span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>autoencoder <span class="op">=</span> Model(input_img, decoded)</span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a>autoencoder.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>)</span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb106-36"><a href="#cb106-36" aria-hidden="true" tabindex="-1"></a>autoencoder.fit(x_train, x_train, epochs<span class="op">=</span>nb_epoch, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>, validation_data<span class="op">=</span>(x_test, x_test))</span>
<span id="cb106-37"><a href="#cb106-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-38"><a href="#cb106-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb106-39"><a href="#cb106-39" aria-hidden="true" tabindex="-1"></a>evaluation <span class="op">=</span> autoencoder.evaluate(x_test, x_test, batch_size<span class="op">=</span>batch_size, verbose<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb106-40"><a href="#cb106-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">Summary: Loss over the test dataset: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> (evaluation))</span>
<span id="cb106-41"><a href="#cb106-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-42"><a href="#cb106-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Decode test images</span></span>
<span id="cb106-43"><a href="#cb106-43" aria-hidden="true" tabindex="-1"></a><span class="co"># decoded_imgs = autoencoder.predict(x_test)</span></span>
<span id="cb106-44"><a href="#cb106-44" aria-hidden="true" tabindex="-1"></a><span class="co"># n = 10  # Number of digits to display</span></span>
<span id="cb106-45"><a href="#cb106-45" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.figure(figsize=(20, 4))</span></span>
<span id="cb106-46"><a href="#cb106-46" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(n):</span></span>
<span id="cb106-47"><a href="#cb106-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Display original</span></span>
<span id="cb106-48"><a href="#cb106-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax = plt.subplot(2, n, i + 1)</span></span>
<span id="cb106-49"><a href="#cb106-49" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.imshow(x_test[i].reshape(28, 28))</span></span>
<span id="cb106-50"><a href="#cb106-50" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.gray()</span></span>
<span id="cb106-51"><a href="#cb106-51" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_xaxis().set_visible(False)</span></span>
<span id="cb106-52"><a href="#cb106-52" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_yaxis().set_visible(False)</span></span>
<span id="cb106-53"><a href="#cb106-53" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Display reconstruction</span></span>
<span id="cb106-54"><a href="#cb106-54" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax = plt.subplot(2, n, i + 1 + n)</span></span>
<span id="cb106-55"><a href="#cb106-55" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.imshow(decoded_imgs[i].reshape(28, 28))</span></span>
<span id="cb106-56"><a href="#cb106-56" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.gray()</span></span>
<span id="cb106-57"><a href="#cb106-57" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_xaxis().set_visible(False)</span></span>
<span id="cb106-58"><a href="#cb106-58" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_yaxis().set_visible(False)</span></span>
<span id="cb106-59"><a href="#cb106-59" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span>
<span id="cb106-60"><a href="#cb106-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-61"><a href="#cb106-61" aria-hidden="true" tabindex="-1"></a><span class="co"># # Visualize the encoded representations</span></span>
<span id="cb106-62"><a href="#cb106-62" aria-hidden="true" tabindex="-1"></a><span class="co"># encoder = Model(input_img, encoded)</span></span>
<span id="cb106-63"><a href="#cb106-63" aria-hidden="true" tabindex="-1"></a><span class="co"># encoded_imgs = encoder.predict(x_test)</span></span>
<span id="cb106-64"><a href="#cb106-64" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.figure(figsize=(8, 6))</span></span>
<span id="cb106-65"><a href="#cb106-65" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.scatter(encoded_imgs[:, 0], encoded_imgs[:, 1], c=_)</span></span>
<span id="cb106-66"><a href="#cb106-66" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.colorbar()</span></span>
<span id="cb106-67"><a href="#cb106-67" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(60000, 784)
(10000, 784)
Epoch 1/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 8s 10ms/step - loss: 0.2449 - val_loss: 0.1176
Epoch 2/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 1s 3ms/step - loss: 0.1136 - val_loss: 0.1015
Epoch 3/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 3s 4ms/step - loss: 0.1002 - val_loss: 0.0953
Epoch 4/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 2s 3ms/step - loss: 0.0941 - val_loss: 0.0904
Epoch 5/5
469/469 ━━━━━━━━━━━━━━━━━━━━ 1s 3ms/step - loss: 0.0900 - val_loss: 0.0875
79/79 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - loss: 0.0874

Summary: Loss over the test dataset: 0.09</code></pre>
</div>
</div>
</section>
<section id="denoise" class="level2">
<h2 class="anchored" data-anchor-id="denoise">Denoise</h2>
</section>
<section id="implementation-of-a-denoising-autoencoder-using-keras-to-remove-noise-from-images-in-the-mnist-dataset" class="level2">
<h2 class="anchored" data-anchor-id="implementation-of-a-denoising-autoencoder-using-keras-to-remove-noise-from-images-in-the-mnist-dataset">Implementation of a denoising autoencoder using Keras to remove noise from images in the MNIST dataset</h2>
<div id="cell-83" class="cell" data-outputid="42b4c00b-c593-4960-f8c7-1f428cd205c7" data-execution_count="86">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Model</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense, Input</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.datasets <span class="im">import</span> mnist</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load MNIST Dataset</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>(x_train, _), (x_test, _) <span class="op">=</span> mnist.load_data()</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> x_train <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> x_test <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> x_train.reshape((<span class="bu">len</span>(x_train), np.prod(x_train.shape[<span class="dv">1</span>:])))</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> x_test.reshape((<span class="bu">len</span>(x_test), np.prod(x_test.shape[<span class="dv">1</span>:])))</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_train.shape)</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_test.shape)</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add noise to the data</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>noise_factor <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>x_train_noisy <span class="op">=</span> x_train <span class="op">+</span> noise_factor <span class="op">*</span> np.random.normal(loc<span class="op">=</span><span class="fl">0.0</span>, scale<span class="op">=</span><span class="fl">1.0</span>, size<span class="op">=</span>x_train.shape)</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>x_test_noisy <span class="op">=</span> x_test <span class="op">+</span> noise_factor <span class="op">*</span> np.random.normal(loc<span class="op">=</span><span class="fl">0.0</span>, scale<span class="op">=</span><span class="fl">1.0</span>, size<span class="op">=</span>x_test.shape)</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>x_train_noisy <span class="op">=</span> np.clip(x_train_noisy, <span class="fl">0.</span>, <span class="fl">1.</span>)</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>x_test_noisy <span class="op">=</span> np.clip(x_test_noisy, <span class="fl">0.</span>, <span class="fl">1.</span>)</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize some of the noisy images</span></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a><span class="co"># n = 10  # Number of digits to display</span></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.figure(figsize=(20, 4))</span></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(n):</span></span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax = plt.subplot(1, n, i + 1)</span></span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.imshow(x_test_noisy[i].reshape(28, 28))</span></span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.gray()</span></span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_xaxis().set_visible(False)</span></span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_yaxis().set_visible(False)</span></span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Hyperparameters</span></span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>nb_epoch <span class="op">=</span> <span class="dv">2</span> <span class="co"># Increase epochs for better training</span></span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a>nb_visible <span class="op">=</span> <span class="dv">784</span></span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a>encoding_dim <span class="op">=</span> <span class="dv">64</span>  <span class="co"># Compressed representation</span></span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-40"><a href="#cb108-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Build denoising autoencoder model</span></span>
<span id="cb108-41"><a href="#cb108-41" aria-hidden="true" tabindex="-1"></a>input_img <span class="op">=</span> Input(shape<span class="op">=</span>(nb_visible,))</span>
<span id="cb108-42"><a href="#cb108-42" aria-hidden="true" tabindex="-1"></a>encoded <span class="op">=</span> Dense(<span class="dv">512</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(input_img)</span>
<span id="cb108-43"><a href="#cb108-43" aria-hidden="true" tabindex="-1"></a>encoded <span class="op">=</span> Dense(<span class="dv">256</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(encoded)</span>
<span id="cb108-44"><a href="#cb108-44" aria-hidden="true" tabindex="-1"></a>encoded <span class="op">=</span> Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(encoded)</span>
<span id="cb108-45"><a href="#cb108-45" aria-hidden="true" tabindex="-1"></a>encoded <span class="op">=</span> Dense(encoding_dim, activation<span class="op">=</span><span class="st">'relu'</span>)(encoded)</span>
<span id="cb108-46"><a href="#cb108-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-47"><a href="#cb108-47" aria-hidden="true" tabindex="-1"></a>decoded <span class="op">=</span> Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(encoded)</span>
<span id="cb108-48"><a href="#cb108-48" aria-hidden="true" tabindex="-1"></a>decoded <span class="op">=</span> Dense(<span class="dv">256</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(decoded)</span>
<span id="cb108-49"><a href="#cb108-49" aria-hidden="true" tabindex="-1"></a>decoded <span class="op">=</span> Dense(<span class="dv">512</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(decoded)</span>
<span id="cb108-50"><a href="#cb108-50" aria-hidden="true" tabindex="-1"></a>decoded <span class="op">=</span> Dense(nb_visible, activation<span class="op">=</span><span class="st">'sigmoid'</span>)(decoded)</span>
<span id="cb108-51"><a href="#cb108-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-52"><a href="#cb108-52" aria-hidden="true" tabindex="-1"></a>autoencoder <span class="op">=</span> Model(input_img, decoded)</span>
<span id="cb108-53"><a href="#cb108-53" aria-hidden="true" tabindex="-1"></a>autoencoder.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>)</span>
<span id="cb108-54"><a href="#cb108-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-55"><a href="#cb108-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb108-56"><a href="#cb108-56" aria-hidden="true" tabindex="-1"></a>autoencoder.fit(x_train_noisy, x_train, epochs<span class="op">=</span>nb_epoch, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>, validation_data<span class="op">=</span>(x_test_noisy, x_test))</span>
<span id="cb108-57"><a href="#cb108-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-58"><a href="#cb108-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb108-59"><a href="#cb108-59" aria-hidden="true" tabindex="-1"></a>evaluation <span class="op">=</span> autoencoder.evaluate(x_test_noisy, x_test, batch_size<span class="op">=</span>batch_size, verbose<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb108-60"><a href="#cb108-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">Summary: Loss over the test dataset: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> (evaluation))</span>
<span id="cb108-61"><a href="#cb108-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-62"><a href="#cb108-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Decode test images</span></span>
<span id="cb108-63"><a href="#cb108-63" aria-hidden="true" tabindex="-1"></a><span class="co"># decoded_imgs = autoencoder.predict(x_test_noisy)</span></span>
<span id="cb108-64"><a href="#cb108-64" aria-hidden="true" tabindex="-1"></a><span class="co"># n = 10  # Number of digits to display</span></span>
<span id="cb108-65"><a href="#cb108-65" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.figure(figsize=(20, 4))</span></span>
<span id="cb108-66"><a href="#cb108-66" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(n):</span></span>
<span id="cb108-67"><a href="#cb108-67" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Display original</span></span>
<span id="cb108-68"><a href="#cb108-68" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax = plt.subplot(3, n, i + 1)</span></span>
<span id="cb108-69"><a href="#cb108-69" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.imshow(x_test[i].reshape(28, 28))</span></span>
<span id="cb108-70"><a href="#cb108-70" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.gray()</span></span>
<span id="cb108-71"><a href="#cb108-71" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_xaxis().set_visible(False)</span></span>
<span id="cb108-72"><a href="#cb108-72" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_yaxis().set_visible(False)</span></span>
<span id="cb108-73"><a href="#cb108-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-74"><a href="#cb108-74" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Display noisy</span></span>
<span id="cb108-75"><a href="#cb108-75" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax = plt.subplot(3, n, i + 1 + n)</span></span>
<span id="cb108-76"><a href="#cb108-76" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.imshow(x_test_noisy[i].reshape(28, 28))</span></span>
<span id="cb108-77"><a href="#cb108-77" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.gray()</span></span>
<span id="cb108-78"><a href="#cb108-78" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_xaxis().set_visible(False)</span></span>
<span id="cb108-79"><a href="#cb108-79" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_yaxis().set_visible(False)</span></span>
<span id="cb108-80"><a href="#cb108-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-81"><a href="#cb108-81" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Display reconstruction</span></span>
<span id="cb108-82"><a href="#cb108-82" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax = plt.subplot(3, n, i + 1 + 2*n)</span></span>
<span id="cb108-83"><a href="#cb108-83" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.imshow(decoded_imgs[i].reshape(28, 28))</span></span>
<span id="cb108-84"><a href="#cb108-84" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.gray()</span></span>
<span id="cb108-85"><a href="#cb108-85" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_xaxis().set_visible(False)</span></span>
<span id="cb108-86"><a href="#cb108-86" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.get_yaxis().set_visible(False)</span></span>
<span id="cb108-87"><a href="#cb108-87" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(60000, 784)
(10000, 784)
Epoch 1/2
469/469 ━━━━━━━━━━━━━━━━━━━━ 6s 6ms/step - loss: 0.2677 - val_loss: 0.1618
Epoch 2/2
469/469 ━━━━━━━━━━━━━━━━━━━━ 3s 3ms/step - loss: 0.1564 - val_loss: 0.1406
79/79 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - loss: 0.1411

Summary: Loss over the test dataset: 0.14</code></pre>
</div>
</div>
</section>
</section>
<section id="module-5---genetic-algo" class="level1">
<h1>Module 5 - Genetic Algo</h1>
<section id="implementation-of-a-genetic-algorithm-used-to-optimize-the-hyperparameters-of-a-neural-network-trained-on-the-iris-dataset." class="level2">
<h2 class="anchored" data-anchor-id="implementation-of-a-genetic-algorithm-used-to-optimize-the-hyperparameters-of-a-neural-network-trained-on-the-iris-dataset.">implementation of a genetic algorithm used to optimize the hyperparameters of a neural network trained on the Iris dataset.</h2>
<div id="cell-86" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import numpy as np</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="co"># import tensorflow as tf</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from sklearn.datasets import load_iris</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co"># from sklearn.model_selection import train_test_split</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Load the Iris dataset</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co"># iris = load_iris()</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co"># X, y = iris.data, iris.target</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # Split the dataset into training and validation sets</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="co"># X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.2, random_state=42)</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # Define the neural network model</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="co"># def create_model(hidden_units, learning_rate):</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     model = tf.keras.Sequential([</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="co">#         tf.keras.layers.Dense(hidden_units, activation='relu', input_shape=(4,)),</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a><span class="co">#         tf.keras.layers.Dense(3, activation='softmax')</span></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     ])</span></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     optimizer = tf.keras.optimizers.Adam(learning_rate=learning_rate)</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     model.compile(optimizer=optimizer, loss='sparse_categorical_crossentropy', metrics=['accuracy'])</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     return model</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Genetic algorithm functions</span></span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_population(population_size):</span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>    population <span class="op">=</span> []</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(population_size):</span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>        hidden_units <span class="op">=</span> np.random.randint(<span class="dv">4</span>, <span class="dv">20</span>)</span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>        learning_rate <span class="op">=</span> <span class="dv">10</span><span class="op">**</span>np.random.uniform(<span class="op">-</span><span class="dv">3</span>, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>        population.append({<span class="st">'hidden_units'</span>: hidden_units, <span class="st">'learning_rate'</span>: learning_rate})</span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> population</span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_fitness(individual):</span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> create_model(individual[<span class="st">'hidden_units'</span>], individual[<span class="st">'learning_rate'</span>])</span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train, epochs<span class="op">=</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>    loss, accuracy <span class="op">=</span> model.evaluate(X_val, y_val, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> accuracy</span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_individuals(population, num_parents):</span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a>    fitness_scores <span class="op">=</span> [evaluate_fitness(individual) <span class="cf">for</span> individual <span class="kw">in</span> population]</span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a>    selected_indices <span class="op">=</span> np.argsort(fitness_scores)[<span class="op">-</span>num_parents:]</span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [population[i] <span class="cf">for</span> i <span class="kw">in</span> selected_indices]</span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> crossover(parent1, parent2):</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>    child <span class="op">=</span> {<span class="st">'hidden_units'</span>: parent1[<span class="st">'hidden_units'</span>], <span class="st">'learning_rate'</span>: parent2[<span class="st">'learning_rate'</span>]}</span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> child</span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mutate(individual):</span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> np.random.rand() <span class="op">&lt;</span> <span class="fl">0.5</span>:</span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a>        individual[<span class="st">'hidden_units'</span>] <span class="op">+=</span> np.random.randint(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a>        individual[<span class="st">'learning_rate'</span>] <span class="op">*=</span> np.random.uniform(<span class="fl">0.9</span>, <span class="fl">1.1</span>)</span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> individual</span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a><span class="co"># def genetic_algorithm(population_size, num_generations, num_parents):</span></span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a><span class="co">#     population = initialize_population(population_size)</span></span>
<span id="cb110-56"><a href="#cb110-56" aria-hidden="true" tabindex="-1"></a><span class="co">#     for generation in range(num_generations):</span></span>
<span id="cb110-57"><a href="#cb110-57" aria-hidden="true" tabindex="-1"></a><span class="co">#         parents = select_individuals(population, num_parents)</span></span>
<span id="cb110-58"><a href="#cb110-58" aria-hidden="true" tabindex="-1"></a><span class="co">#         offspring = [crossover(parents[i % num_parents], parents[(i+1) % num_parents]) for i in range(population_size)]</span></span>
<span id="cb110-59"><a href="#cb110-59" aria-hidden="true" tabindex="-1"></a><span class="co">#         offspring = [mutate(individual) for individual in offspring]</span></span>
<span id="cb110-60"><a href="#cb110-60" aria-hidden="true" tabindex="-1"></a><span class="co">#         population = offspring</span></span>
<span id="cb110-61"><a href="#cb110-61" aria-hidden="true" tabindex="-1"></a><span class="co">#     best_individual = max(population, key=evaluate_fitness)</span></span>
<span id="cb110-62"><a href="#cb110-62" aria-hidden="true" tabindex="-1"></a><span class="co">#     return best_individual</span></span>
<span id="cb110-63"><a href="#cb110-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-64"><a href="#cb110-64" aria-hidden="true" tabindex="-1"></a><span class="co"># # Run the genetic algorithm to find the best hyperparameters</span></span>
<span id="cb110-65"><a href="#cb110-65" aria-hidden="true" tabindex="-1"></a><span class="co"># best_hyperparameters = genetic_algorithm(population_size=10, num_generations=10, num_parents=3)</span></span>
<span id="cb110-66"><a href="#cb110-66" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Best hyperparameters found:", best_hyperparameters)</span></span>
<span id="cb110-67"><a href="#cb110-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-68"><a href="#cb110-68" aria-hidden="true" tabindex="-1"></a><span class="co"># # Train the final model with the best hyperparameters</span></span>
<span id="cb110-69"><a href="#cb110-69" aria-hidden="true" tabindex="-1"></a><span class="co"># best_model = create_model(best_hyperparameters['hidden_units'], best_hyperparameters['learning_rate'])</span></span>
<span id="cb110-70"><a href="#cb110-70" aria-hidden="true" tabindex="-1"></a><span class="co"># best_model.fit(X_train, y_train, epochs=1, validation_data=(X_val, y_val), verbose=2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="module-5---gan" class="level1">
<h1>Module 5 - GAN</h1>
<section id="implementation-of-a-generative-adversarial-network-gan-to-generate-synthetic-mnist-like-grayscale-images-of-handwritten-digits" class="level2">
<h2 class="anchored" data-anchor-id="implementation-of-a-generative-adversarial-network-gan-to-generate-synthetic-mnist-like-grayscale-images-of-handwritten-digits">Implementation of a Generative Adversarial Network (GAN) to generate synthetic MNIST-like grayscale images of handwritten digits</h2>
<div id="cell-89" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import numpy as np</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co"># import tensorflow as tf</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from tensorflow import keras</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co"># from tensorflow.keras.layers import (Dense, Flatten, Reshape,</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                      Conv2D, Conv2DTranspose, LeakyReLU, BatchNormalization)</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="co"># from tensorflow.keras.datasets import mnist</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co"># import matplotlib.pyplot as plt</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generator</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_generator_model():</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> keras.Sequential()</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Foundation for 7x7 image</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">7</span> <span class="op">*</span> <span class="dv">7</span> <span class="op">*</span> <span class="dv">256</span>, activation<span class="op">=</span><span class="st">'relu'</span>, input_shape<span class="op">=</span>(NOISE_DIM,)))</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>    model.add(Reshape((<span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">256</span>)))</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Upsample to 14x14</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>    model.add(Conv2DTranspose(<span class="dv">128</span>, (<span class="dv">5</span>, <span class="dv">5</span>), strides<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>), padding<span class="op">=</span><span class="st">'same'</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>    model.add(BatchNormalization())</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Upsample to 28x28</span></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>    model.add(Conv2DTranspose(<span class="dv">64</span>, (<span class="dv">5</span>, <span class="dv">5</span>), strides<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">2</span>), padding<span class="op">=</span><span class="st">'same'</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>    model.add(BatchNormalization())</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>    model.add(Conv2DTranspose(<span class="dv">1</span>, (<span class="dv">5</span>, <span class="dv">5</span>), strides<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">2</span>), padding<span class="op">=</span><span class="st">'same'</span>,</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>                              activation<span class="op">=</span><span class="st">'tanh'</span>))  <span class="co"># Single channel for grayscale MNIST images</span></span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Discriminator</span></span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_discriminator_model():</span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> keras.Sequential()</span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a>    model.add(Conv2D(<span class="dv">64</span>, (<span class="dv">5</span>, <span class="dv">5</span>), strides<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">2</span>), padding<span class="op">=</span><span class="st">'same'</span>, input_shape<span class="op">=</span>[<span class="dv">28</span>, <span class="dv">28</span>, <span class="dv">1</span>]))</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>    model.add(LeakyReLU())</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a>    model.add(BatchNormalization())</span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a>    model.add(Conv2D(<span class="dv">128</span>, (<span class="dv">5</span>, <span class="dv">5</span>), strides<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">2</span>), padding<span class="op">=</span><span class="st">'same'</span>))</span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a>    model.add(LeakyReLU())</span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a>    model.add(BatchNormalization())</span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a>    model.add(Flatten())</span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">1</span>))  <span class="co"># No activation here since we use from_logits=True in the loss</span></span>
<span id="cb111-36"><a href="#cb111-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span>
<span id="cb111-37"><a href="#cb111-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-38"><a href="#cb111-38" aria-hidden="true" tabindex="-1"></a><span class="co"># def discriminator_loss(real_output, fake_output):</span></span>
<span id="cb111-39"><a href="#cb111-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     real_loss = cross_entropy(tf.ones_like(real_output), real_output)</span></span>
<span id="cb111-40"><a href="#cb111-40" aria-hidden="true" tabindex="-1"></a><span class="co">#     fake_loss = cross_entropy(tf.zeros_like(fake_output), fake_output)</span></span>
<span id="cb111-41"><a href="#cb111-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     total_loss = real_loss + fake_loss</span></span>
<span id="cb111-42"><a href="#cb111-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     return total_loss</span></span>
<span id="cb111-43"><a href="#cb111-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-44"><a href="#cb111-44" aria-hidden="true" tabindex="-1"></a><span class="co"># def generator_loss(fake_output):</span></span>
<span id="cb111-45"><a href="#cb111-45" aria-hidden="true" tabindex="-1"></a><span class="co">#     return cross_entropy(tf.ones_like(fake_output), fake_output)</span></span>
<span id="cb111-46"><a href="#cb111-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-47"><a href="#cb111-47" aria-hidden="true" tabindex="-1"></a><span class="co"># # Training loop</span></span>
<span id="cb111-48"><a href="#cb111-48" aria-hidden="true" tabindex="-1"></a><span class="co"># def train_step(images):</span></span>
<span id="cb111-49"><a href="#cb111-49" aria-hidden="true" tabindex="-1"></a><span class="co">#     noise = tf.random.normal([BATCH_SIZE, NOISE_DIM])</span></span>
<span id="cb111-50"><a href="#cb111-50" aria-hidden="true" tabindex="-1"></a><span class="co">#     with tf.GradientTape() as gen_tape, tf.GradientTape() as disc_tape:</span></span>
<span id="cb111-51"><a href="#cb111-51" aria-hidden="true" tabindex="-1"></a><span class="co">#         generated_images = generator(noise, training=True)</span></span>
<span id="cb111-52"><a href="#cb111-52" aria-hidden="true" tabindex="-1"></a><span class="co">#         real_output = discriminator(images, training=True)</span></span>
<span id="cb111-53"><a href="#cb111-53" aria-hidden="true" tabindex="-1"></a><span class="co">#         fake_output = discriminator(generated_images, training=True)</span></span>
<span id="cb111-54"><a href="#cb111-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-55"><a href="#cb111-55" aria-hidden="true" tabindex="-1"></a><span class="co">#         gen_loss = generator_loss(fake_output)</span></span>
<span id="cb111-56"><a href="#cb111-56" aria-hidden="true" tabindex="-1"></a><span class="co">#         disc_loss = discriminator_loss(real_output, fake_output)</span></span>
<span id="cb111-57"><a href="#cb111-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-58"><a href="#cb111-58" aria-hidden="true" tabindex="-1"></a><span class="co">#     gradients_of_generator = gen_tape.gradient(gen_loss, generator.trainable_variables)</span></span>
<span id="cb111-59"><a href="#cb111-59" aria-hidden="true" tabindex="-1"></a><span class="co">#     gradients_of_discriminator = disc_tape.gradient(disc_loss, discriminator.trainable_variables)</span></span>
<span id="cb111-60"><a href="#cb111-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-61"><a href="#cb111-61" aria-hidden="true" tabindex="-1"></a><span class="co">#     generator_optimizer.apply_gradients(zip(gradients_of_generator, generator.trainable_variables))</span></span>
<span id="cb111-62"><a href="#cb111-62" aria-hidden="true" tabindex="-1"></a><span class="co">#     discriminator_optimizer.apply_gradients(zip(gradients_of_discriminator, discriminator.trainable_variables))</span></span>
<span id="cb111-63"><a href="#cb111-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-64"><a href="#cb111-64" aria-hidden="true" tabindex="-1"></a><span class="co"># def train(dataset, epochs):</span></span>
<span id="cb111-65"><a href="#cb111-65" aria-hidden="true" tabindex="-1"></a><span class="co">#     for epoch in range(epochs):</span></span>
<span id="cb111-66"><a href="#cb111-66" aria-hidden="true" tabindex="-1"></a><span class="co">#         for image_batch in dataset:</span></span>
<span id="cb111-67"><a href="#cb111-67" aria-hidden="true" tabindex="-1"></a><span class="co">#             train_step(image_batch)</span></span>
<span id="cb111-68"><a href="#cb111-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-69"><a href="#cb111-69" aria-hidden="true" tabindex="-1"></a><span class="co"># # Generate and save images</span></span>
<span id="cb111-70"><a href="#cb111-70" aria-hidden="true" tabindex="-1"></a><span class="co"># def generate_and_save_images(model, epoch, test_input):</span></span>
<span id="cb111-71"><a href="#cb111-71" aria-hidden="true" tabindex="-1"></a><span class="co">#     predictions = model(test_input, training=False)</span></span>
<span id="cb111-72"><a href="#cb111-72" aria-hidden="true" tabindex="-1"></a><span class="co">#     predictions = tf.reshape(predictions, (-1, 28, 28))  # Reshape to [batch_size, 28, 28]</span></span>
<span id="cb111-73"><a href="#cb111-73" aria-hidden="true" tabindex="-1"></a><span class="co">#     fig = plt.figure(figsize=(4, 4))</span></span>
<span id="cb111-74"><a href="#cb111-74" aria-hidden="true" tabindex="-1"></a><span class="co">#     for i in range(predictions.shape[0]):</span></span>
<span id="cb111-75"><a href="#cb111-75" aria-hidden="true" tabindex="-1"></a><span class="co">#         plt.subplot(4, 4, i + 1)</span></span>
<span id="cb111-76"><a href="#cb111-76" aria-hidden="true" tabindex="-1"></a><span class="co">#         plt.imshow(predictions[i] * 127.5 + 127.5, cmap='gray')</span></span>
<span id="cb111-77"><a href="#cb111-77" aria-hidden="true" tabindex="-1"></a><span class="co">#         plt.axis('off')</span></span>
<span id="cb111-78"><a href="#cb111-78" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.savefig(f'image_at_epoch_{epoch:04d}.png')</span></span>
<span id="cb111-79"><a href="#cb111-79" aria-hidden="true" tabindex="-1"></a><span class="co">#     plt.show()</span></span>
<span id="cb111-80"><a href="#cb111-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-81"><a href="#cb111-81" aria-hidden="true" tabindex="-1"></a><span class="co"># if __name__ == "__main__":</span></span>
<span id="cb111-82"><a href="#cb111-82" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Load the dataset</span></span>
<span id="cb111-83"><a href="#cb111-83" aria-hidden="true" tabindex="-1"></a><span class="co">#     (train_images, train_labels), (_, _) = mnist.load_data()</span></span>
<span id="cb111-84"><a href="#cb111-84" aria-hidden="true" tabindex="-1"></a><span class="co">#     train_images = train_images.reshape(train_images.shape[0], 28, 28, 1).astype('float32')</span></span>
<span id="cb111-85"><a href="#cb111-85" aria-hidden="true" tabindex="-1"></a><span class="co">#     train_images = (train_images - 127.5) / 127.5  # Normalize the images to [-1, 1]</span></span>
<span id="cb111-86"><a href="#cb111-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-87"><a href="#cb111-87" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Hyperparameters</span></span>
<span id="cb111-88"><a href="#cb111-88" aria-hidden="true" tabindex="-1"></a><span class="co">#     BUFFER_SIZE = 60000</span></span>
<span id="cb111-89"><a href="#cb111-89" aria-hidden="true" tabindex="-1"></a><span class="co">#     BATCH_SIZE = 256</span></span>
<span id="cb111-90"><a href="#cb111-90" aria-hidden="true" tabindex="-1"></a><span class="co">#     NOISE_DIM = 100</span></span>
<span id="cb111-91"><a href="#cb111-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-92"><a href="#cb111-92" aria-hidden="true" tabindex="-1"></a><span class="co">#     generator = make_generator_model()</span></span>
<span id="cb111-93"><a href="#cb111-93" aria-hidden="true" tabindex="-1"></a><span class="co">#     discriminator = make_discriminator_model()</span></span>
<span id="cb111-94"><a href="#cb111-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-95"><a href="#cb111-95" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Define the loss and optimizers</span></span>
<span id="cb111-96"><a href="#cb111-96" aria-hidden="true" tabindex="-1"></a><span class="co">#     cross_entropy = tf.keras.losses.BinaryCrossentropy(from_logits=True)</span></span>
<span id="cb111-97"><a href="#cb111-97" aria-hidden="true" tabindex="-1"></a><span class="co">#     generator_optimizer = tf.keras.optimizers.Adam(1e-4)</span></span>
<span id="cb111-98"><a href="#cb111-98" aria-hidden="true" tabindex="-1"></a><span class="co">#     discriminator_optimizer = tf.keras.optimizers.Adam(1e-4)</span></span>
<span id="cb111-99"><a href="#cb111-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-100"><a href="#cb111-100" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Batch and shuffle the data</span></span>
<span id="cb111-101"><a href="#cb111-101" aria-hidden="true" tabindex="-1"></a><span class="co">#     train_dataset = tf.data.Dataset.from_tensor_slices(train_images).shuffle(BUFFER_SIZE).batch(BATCH_SIZE)</span></span>
<span id="cb111-102"><a href="#cb111-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-103"><a href="#cb111-103" aria-hidden="true" tabindex="-1"></a><span class="co">#     EPOCHS = 1</span></span>
<span id="cb111-104"><a href="#cb111-104" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Train the GAN</span></span>
<span id="cb111-105"><a href="#cb111-105" aria-hidden="true" tabindex="-1"></a><span class="co">#     train(train_dataset, EPOCHS)</span></span>
<span id="cb111-106"><a href="#cb111-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-107"><a href="#cb111-107" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Generate some test noise samples</span></span>
<span id="cb111-108"><a href="#cb111-108" aria-hidden="true" tabindex="-1"></a><span class="co">#     test_input = tf.random.normal([16, NOISE_DIM])</span></span>
<span id="cb111-109"><a href="#cb111-109" aria-hidden="true" tabindex="-1"></a><span class="co">#     generate_and_save_images(generator, EPOCHS, test_input)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>